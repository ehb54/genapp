var ga={tmp:{},fielderrors:0};
(function(a,b){a.jstree.defaults.conditionalselect=function(){return!0};a.jstree.plugins.conditionalselect=function(a,b){this.activate_node=function(a,c){this.settings.conditionalselect.call(this,this.get_node(a))&&b.activate_node.call(this,a,c)}};a.jstree.plugins.singleselect=function(a,b){this.activate_node=function(a,c){this.is_leaf(a)&&b.activate_node.call(this,a,c)}};a.jstree.plugins.selectonlyleaf=function(a,b){this.activate_node=function(a,c){this.is_leaf(a)&&b.activate_node.call(this,a,c)}};
a.jstree.plugins.singleselectpath=function(a,b){this.activate_node=function(a,c){this.is_leaf(a)||b.activate_node.call(this,a,c)}};a.jstree.plugins.selectnoleaf=function(a,b){this.activate_node=function(a,c){this.is_leaf(a)||b.activate_node.call(this,a,c)}};a.jstree.defaults.sort=function(a,b){return this.get_node(a).data.time<this.get_node(b).data.time?1:-1}})(jQuery);RegExp.quote=function(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")};
Object.size=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};ga.set=function(a,b){b&&(ga.set.data[a]=b);return ga.set.data[a]};ga.set.data={};ga.restricted={};ga.restricted.add=function(a,b){ga.restricted.ids[a]=ga.restricted.ids[a]||[];ga.restricted.ids[a].push(b)};ga.restricted.hideall=function(){var a;ga.restricted.data={};for(a in ga.restricted.ids)$(ga.restricted.ids[a].join()).hide()};
ga.restricted.show=function(a){for(var b in a)ga.restricted.data[a[b]]=1,ga.restricted.ids[a[b]]&&$(ga.restricted.ids[a[b]].join()).show()};ga.specproj=function(a,b){var c={};c.id=a;c.value=b;ga.specproj.data.push(c)};ga.specproj.data=[];ga.specproj.clear=function(){ga.specproj.data=[]};
ga.specproj.gname=function(){var a,b,c="";for(a in ga.specproj.data)ga.specproj.data.hasOwnProperty(a)&&(b=$(ga.specproj.data[a].value).val(),b==parseFloat(b)&&(b=parseFloat(b)),b=ga.specproj.data[a].id+b,c+=b.replace(/[^A-z0-9.-]+/g,"_"));return c};ga.urlparams=function(a){for(var b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]==a)return d[1]}};ga.frontpage=function(a){$("html").load(a)};
ga.loader=function(a,b){ga.loader.jqtag=a;ga.loader.delay=b};ga.loader.timeout=null;ga.loader.startshow=function(){ga.loader.timeout?(clearTimeout(ga.loader.timeout),ga.loader.timeout=null,$(ga.loader.jqtag).show()):$(ga.loader.jqtag).hide()};ga.loader.hide=function(){ga.loader.timeout&&(clearTimeout(ga.loader.timeout),ga.loader.timeout=null);$(ga.loader.jqtag).hide()};ga.loader.show=function(){ga.loader.timeout&&clearTimeout(ga.loader.timeout);ga.loader.timeout=setTimeout(ga.loader.startshow(),ga.loader.delay)};
ga.menumodules=[];ga.group={};ga.group.set=function(a){ga.group.all=a};ga.group.setuser=function(a){var b;ga.group.user=a;ga.group.userhas={};for(b in ga.group.user)ga.group.userhas[ga.group.user[b]]=1;ga.group.show()};
ga.group.inputhtml=function(a){var b="",c,d;ga.group.activeids={};if(!ga.group.all)return b;for(c in ga.group.all)ga.group.all[c].userconfig&&(d="_setgroup_"+a+"_"+c,b+='<tr><td><label for="'+d+'" class="highlight">'+(ga.group.all[c].label?ga.group.all[c].label:c)+'</label></td><td><input type="checkbox" name="'+d+'" id="'+d+'"'+(ga.group.userhas[c]?" checked":"")+(ga.group.all[c].help?' class="help_link"><span class="help">'+ga.group.all[c].help+"</span":"")+"></td></tr>",ga.group.activeids[c]=d);
return b};ga.group.addmenu=function(a,b){ga.group.menuids[a]=ga.group.menuids[a]||[];ga.group.menuids[a].push(b)};ga.group.hideall=function(){for(var a in ga.group.menuids)$(ga.group.menuids[a].join()).hide()};ga.group.show=function(){var a;ga.group.hideall();for(a in ga.group.userhas)ga.group.menuids[a]&&$(ga.group.menuids[a].join()).show();ga.group.menuids.login&&$(ga.group.menuids.login.join()).show()};
ga.browser=function(){var a=navigator.userAgent;ga.browser.type="unknown";ga.browser.prefix="";ga.browser.gradient=!1;ga.browser.clrpkr=!1;-1<a.indexOf("Chrome")?(ga.browser.type="chrome",ga.browser.prefix="-webkit-",ga.browser.gradient=!0,ga.browser.clrpkr=!0):-1<a.indexOf("Safari")?(ga.browser.type="safari",ga.browser.prefix="-webkit-",ga.browser.gradient=!0):-1<a.indexOf("Opera")?(ga.browser.type="opera",ga.browser.prefix="-o-",ga.browser.gradient=!0,ga.browser.clrpkr=!0):-1<a.indexOf("Firefox")?
(ga.browser.type="mozilla",ga.browser.prefix="-moz-",ga.browser.gradient=!0,ga.browser.clrpkr=!0):-1<a.indexOf("MSIE")&&(ga.browser.type="msie",ga.browser.prefix="",ga.browser.gradient=!0)};ga.cssrule={};
ga.cssrule.get=function(a,b){a=a.toLowerCase();if(document.styleSheets)for(var c=0;c<document.styleSheets.length;c++){var d=document.styleSheets[c],e=0,g=!1;do{if((g=d.cssRules?d.cssRules[e]:d.rules[e])&&g.selectorText&&g.selectorText.toLowerCase()==a)return"delete"==b?(d.cssRules?d.deleteRule(e):d.removeRule(e),!0):g;e++}while(g)}return!1};ga.cssrule.kill=function(a){return ga.cssrule.get(a,"delete")};
ga.cssrule.add=function(a){document.styleSheets&&(ga.cssrule.get(a)||(document.styleSheets[0].addRule?document.styleSheets[0].addRule(a,null,0):document.styleSheets[0].insertRule(a+" { }",0)));return ga.cssrule.get(a)};ga.cache={};
ga.cache.msg=function(a,b,c,d,e,g,h){switch(a){case "notify":if(ga.restricted.data[b]){messagebox({icon:"question.png",text:"Show or clear previously computed results.",buttons:[{id:"showcached",label:"Show previously computed results",cb:c,adata:[e,0,1,1]},{id:"clear",label:"Clear cached result",cb:ga.cache.clear,adata:[e,b]},{id:"cancel",label:"Cancel"}]});return}messagebox({icon:"information.png",text:"Showing previously computed results."});break;case "askrecompute":ga.restricted.data[b]?messagebox({icon:"question.png",
text:"Previously computed results are available.",buttons:[{id:"showcached",label:"Show previously computed results",cb:c,adata:[e,0,1,1]},{id:"recompute",label:"Recompute results",cb:d,adata:[g,h,1]},{id:"clear",label:"Clear cached result",cb:ga.cache.clear,adata:[e,b]},{id:"cancel",label:"Cancel"}]}):messagebox({icon:"question.png",text:"Previously computed results are available.",buttons:[{id:"showcached",label:"Show previously computed results",cb:c,adata:[e,0,1,1]},{id:"recompute",label:"Recompute results",
cb:d,adata:[g,h,1]},{id:"cancel",label:"Cancel"}]});return;default:if(ga.restricted.data[b]){messagebox({icon:"question.png",text:"Show or clear previously computed results.",buttons:[{id:"showcached",label:"Show previously computed results",cb:c,adata:[e,0,1,1]},{id:"clear",label:"Clear cached result",cb:ga.cache.clear,adata:[e,b]},{id:"cancel",label:"Cancel"}]});return}}c(e,0,1,1)};
ga.cache.clear=function(a,b){messagebox({icon:"admin.png",text:"Are you sure you want to permanently remove this previously computed result?",buttons:[{id:"clear",label:"Clear cached result",cb:ga.cache.doclear,adata:[a,b]},{id:"cancel",label:"Cancel"}]})};
ga.cache.doclear=function(a,b){ga.cache.url_clear?$.getJSON(ga.cache.url_clear,{tagmode:"any",format:"json",_window:window.name,_logon:$("#_state").data("_logon"),_uuid:a,_cachedelete:b}).done(function(a,b,e){"true"==a.success?messagebox({icon:"information.png",text:"Previously computed results cleared"}):messagebox({icon:"toast.png",text:a.error})}).fail(function(a,b,e){console.warn("could not clear cache data");messagebox({icon:"toast.png",text:"Error: server failed to clear cached entry"})}):messagebox({icon:"toast.png",
text:"Internal error: no url defined for cache clear"})};ga.trytilltrue=function(a,b,c,d){if(eval(a))return eval(b);c--;if(0>c)console.warn("ga.trytilltrue failed ... to many tries");else return setTimeout(ga.trytilltrue,d,a,b,c,d)};ga.login={};
ga.login.verify=function(a){var b={text:a.text||"You must verify your email address."};a.useroptions&&(a.useroptions.resend&&(b.buttons=b.buttons||[],b.buttons.push({id:"resend",label:"Resend the verification email",cb:ga.login.verify.resend})),a.useroptions.resend&&(b.buttons=b.buttons||[],b.buttons.push({id:"changeaddress",label:"Change your email address and resend the verification",cb:ga.login.verify.change})),a.useroptions.cancel&&(b.buttons=b.buttons||[],b.buttons.push({id:"cancelregistration",
label:"Cancel your registration",cb:ga.login.verify.cancel})));messagebox(b)};ga.login.verify.resend=function(){var a=$("#sys_login");if(!a)return messagebox({icon:"toast.png",text:"Internal error: form missing"});a.append('<input type="hidden" name="_resendverify" class="toclear">');do_sys_login_submit(a)};
ga.login.verify.change=function(){return messagebox({icon:"question.png",text:'<center><label  class="header3 ">Change email address</label></center><form id="_changeemail"><table><tr><td><label for="_changeemail1">Email address </label></td><td><input type="email" name="_changeemail1" id="_changeemail1" required size="50" class="help_link"><span class="help">Enter a valid email address.  This will be required if you forget your password.  Otherwise, you will have to create a new account lose access to your projects</span><span id="_changeemail1_msg" class="warning field_msg" > </span></td></tr><tr><td><label for="_changeemail2">Repeat email address </label></td><td><input type="email" name="_changeemail2" id="_changeemail2" required size="50" class="help_link"><span class="help">Enter a valid email address.  This will be required if you forget your password.  Otherwise, you will have to create a new account lose access to your projects</span><span id="_changeemail2_msg" class="warning field_msg" > </span></td></tr></table></form><script>$( "#_changeemail1" ).keypress( function() { $( "#_changeemail1_msg" ).html( "" );});$( "#_changeemail2" ).keypress( function() { $( "#_changeemail2_msg" ).html( "" );});$( "#_changeemail2" ).blur( function() { ga.valid.checkMatch( "#_changeemail2", "#_changeemail1" ); } );setHoverHelp();\x3c/script>',buttons:[{id:"_changeemailbutton",
label:"Submit",cb:ga.login.verify.change.doit},{id:"_changeemailcancel",label:"Cancel"}]})};
ga.login.verify.change.doit=function(){var a=$("#sys_login");if(!a)return messagebox({icon:"toast.png",text:"Internal error: form missing"});a.append('<input type="hidden" name="_resendverify" class="toclear">');a.append('<input type="hidden" name="_changeemail" class="toclear">');a.append('<input type="hidden" name="_changeemail1" value="'+$("#_changeemail1").val()+'" class="toclear">');a.append('<input type="hidden" name="_changeemail2" value="'+$("#_changeemail2").val()+'" class="toclear">');do_sys_login_submit(a)};
ga.login.verify.cancel=function(){var a=$("#sys_login");if(!a)return messagebox({icon:"toast.png",text:"Internal error: form missing"});a.append('<input type="hidden" name="_cancel" class="toclear">');do_sys_login_submit(a)};
ga.login.approve=function(a){var b={text:a.text||"Your registration is pending approval."};a.useroptions&&(a.useroptions.resend&&(b.buttons=b.buttons||[],b.buttons.push({id:"resend",label:"Resend the approval request",cb:ga.login.approve.resend})),a.useroptions.cancel&&(b.buttons=b.buttons||[],b.buttons.push({id:"cancelregistration",label:"Cancel your registration request",cb:ga.login.approve.cancel})));messagebox(b)};
ga.login.approve.resend=function(){var a=$("#sys_login");if(!a)return messagebox({icon:"toast.png",text:"Internal error: form missing"});a.append('<input type="hidden" name="_resendapprove" class="toclear">');do_sys_login_submit(a)};ga.login.approve.cancel=function(){var a=$("#sys_login");if(!a)return messagebox({icon:"toast.png",text:"Internal error: form missing"});a.append('<input type="hidden" name="_cancel" class="toclear">');do_sys_login_submit(a)};ga.admin={};
ga.admin.ajax=function(a,b,c,d){$.get(ga.admin.ajax.url,{tagmode:"any",format:"json",_window:window.name,_logon:$("#_state").data("_logon"),_cmd:a,_name:b,_id:c,_manageid:d}).done(function(a,b,c){a=JSON.parse(a.split(/\r?\n/)[1]);"true"!=a.success&&messagebox({icon:"toast.png",text:a.error?a.error:"unknown error"});a._submitid&&$("#"+a._submitid).trigger("click")}).fail(function(a,b,c){messagebox({icon:"toast.png",text:"Error: system user management backend command failed to run: "+c})})};
ga.admin.ajax.remove=function(a,b,c,d){messagebox({icon:"admin.png",text:"Are you sure you want to permanently remove this user, all of their job history and their stored data?",buttons:[{id:"yes",label:"Yes, remove this user",cb:ga.admin.ajax,adata:[a,b,c,d]},{id:"cancel",label:"Cancel"}]})};
ga.extrahidden=function(a){if(ga.set.data.extrahidden&&ga.set.data.extrahidden[a]){var b=$("#"+a),c,d="";for(c in ga.set.data.extrahidden[a])d+='<input type="hidden" name="'+c+'" value="'+ga.set.data.extrahidden[a][c]+'">';b.append(d);delete ga.set.data.extrahidden[a]}};ga.colors=function(a){ga.colors.background=ga.colors.makeRGB(a.background);ga.colors.text=ga.colors.makeRGB(a.text)};
ga.colors.makeRGB=function(a){if(/\d{1,3},\s*\d{1,3},\s*\d{1,3}$/.test(a))return a;a=ga.color.toRGB(a);return a.r+","+a.g+","+a.b};ga.plot_options=function(){var a="rgb( "+ga.colors.text+" )";return{font:{color:a},grid:{hoverable:!1},xaxis:{color:"gray",lineWidth:.5,font:{color:a}},yaxis:{color:"gray",lineWidth:.5,font:{color:a}},lines:{lineWidth:1},zoom:{interactive:!1},pan:{interactive:!1}}};ga.color=function(a){ga.color.data=a;ga.colors(a.body);ga.color.apply()};
ga.color.defaults=function(a){ga.browser();ga.color.defaults.data=a;ga.color(a)};ga.color.toRGB=function(a){var b,c;if("#"===a.slice(0,1))return c=parseInt(a.slice(1),16),b=parseInt(c/256),c-=256*b,a=parseInt(b/256),{r:a,b:c,g:b-256*a};(bits=/^rgb\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\s*\)$/.exec(a))?(a=parseInt(bits[1]),b=parseInt(bits[2]),c=parseInt(bits[3])):c=b=a=128;return{r:a,b:c,g:b}};
ga.color.apply=function(){var a,b,c,d,e,g,h;if(ga.directives.data&&ga.directives.data.usercolors&&!/^(off|0|false)$/.test(ga.directives.data.usercolors)){for(a in ga.color.data)ga.color.data.hasOwnProperty(a)&&(b=$(a))&&b.css(ga.color.data[a]);$(".sidebar ul li, .title").css("color",ga.color.data.body.color).hover(function(){$(this).css("color",ga.color.defaults.data.hovercolor.color)},function(){$(this).css("color",ga.color.data.body.color)});$(".svgmenu").css({color:ga.color.data.body.color,stroke:ga.color.data.body.color}).hover(function(){$(this).css({color:ga.color.defaults.data.hovercolor.color,
stroke:ga.color.defaults.data.hovercolor.color})},function(){$(this).css({color:ga.color.data.body.color,stroke:ga.color.data.body.color})});"#"===ga.color.data.body.background.slice(0,1)?(c=parseInt(ga.color.data.body.background.slice(1),16),b=parseInt(c/256),c-=256*b,a=parseInt(b/256),b-=256*a,a+=128<a?-20:20,b+=128<b?-20:20,c+=128<c?-20:20,$(".help,.coord").css({background:"rgba("+a+","+b+","+c+",0.8)",color:ga.color.data.body.color})):$(".help,.coord").css({background:ga.color.data[".help"].background,
color:ga.color.data[".help"].color});"#"===ga.color.data.body.color.slice(0,1)?(c=parseInt(ga.color.data.body.color.slice(1),16),b=parseInt(c/256),c-=256*b,a=parseInt(b/256),b-=256*a,d=a,e=b,g=c,a+=128<a?-12:12,b+=128<b?-12:12,c+=128<c?-12:12,$(".header1").css({color:"rgb("+a+","+b+","+c+")"}),a+=128<a?-12:12,b+=128<b?-12:12,c+=128<c?-12:12,$(".header2").css({color:"rgb("+a+","+b+","+c+")"}),a+=128<a?-12:12,b+=128<b?-12:12,c+=128<c?-12:12,$(".header3").css({color:"rgb("+a+","+b+","+c+")"}),a+=128<
a?-12:12,b+=128<b?-12:12,c+=128<c?-12:12,$(".header4").css({color:"rgb("+a+","+b+","+c+")"}),a+=128<a?-12:12,b+=128<b?-12:12,c+=128<c?-12:12,$("hr").css({color:"rgb("+a+","+b+","+c+")"}),a=d,b=e,c=g,b+=128<b?-75:75,ga.cssrule.kill("a:link"),h=ga.cssrule.add("a:link"),h.style.color="rgb("+a+","+b+","+c+")",b=e,c+=128<c?-75:75,a+=128<a?-75:75,ga.cssrule.kill("a:visited"),h=ga.cssrule.add("a:visited"),h.style.color="rgb("+a+","+b+","+c+")",c=g,a=d,a+=128<a?-75:75,ga.cssrule.kill("a:active"),h=ga.cssrule.add("a:active"),
h.style.color="rgb("+a+","+b+","+c+")"):($(".header1").css({color:ga.color.data[".header1"]?ga.color.data[".header1"].color:ga.color.data.body.color}),$(".header2").css({color:ga.color.data[".header2"]?ga.color.data[".header2"].color:ga.color.data.body.color}),$(".header3").css({color:ga.color.data[".header3"]?ga.color.data[".header3"].color:ga.color.data.body.color}),$(".header4").css({color:ga.color.data[".header4"]?ga.color.data[".header4"].color:ga.color.data.body.color}));$(".modalDialog > div, .modalDialog2 > div, .modalDialog3 > div, .modalDialog4 > div").css({background:ga.browser.gradient?
ga.browser.prefix+"linear-gradient("+ga.color.data.body.background+", #222)":ga.color.data.body.background})}};ga.color.reset=function(){ga.color(ga.color.defaults.data)};ga.color.spectrum=function(a){if(!ga.browser.clrpkr)$(a).on("change.spectrum",function(b,c){console.log("hi spectrum"+a);$(a).val(c.toHexString())})};ga.color.spectrum.val=function(a,b){if(!ga.browser.clrpkr)if(b)$(a).spectrum({color:b});else return $(a).spectrum("get").toHexString()};
ga.event=function(a,b,c){ga.event.log.push({menu:a,module:b,action:c,when:new Date})};ga.event.log=[];ga.event.list=function(){for(var a=0,b=ga.event.log.length,c="Client Date/Time is "+(new Date).toUTCString()+"\n";a<b;a++)c+=ga.event.log[a].menu+" "+ga.event.log[a].module+" "+ga.event.log[a].action+" "+ga.event.log[a].when.toUTCString()+"\n";return c};
ga.fc=function(a,b){var c,d;ga.fc.cache[a]?b(ga.fc.cache[a]):ga.fc.waits[a]?ga.fc.waits[a].push(b):(ga.fc.waits[a]=[b],$.ajax(ga.fc.url+a).success(function(b){d=ga.fc.waits[a];delete ga.fc.waits[a];b=$.parseJSON(b);ga.fc.cache[a]=b;for(c=d.length;c--;)d[c](b)}).error(function(b){d=ga.fc.waits[a];delete ga.fc.waits[a];console.log("ajax error");console.dir(b);for(c=d.length;c--;)d[c]("**error**");ga.fc.ajax_error_msg("ajax get error: "+b.statusText)}));return!0};
ga.fc.clear=function(a){var b,c=ga.fc.children(a);for(b in c)ga.fc.cache[b]&&delete ga.fc.cache[b];ga.fc.cache[a]&&delete ga.fc.cache[a];for(b in ga.fc.trees)$(b).length&&("#"!==a?$(b).jstree(!0).refresh_node(a):$(b).jstree(!0).refresh())};ga.fc.refresh=function(a){for(var b in ga.fc.trees)$(b).length&&ga.fc.cache[a]&&("#"!==a?$(b).jstree(!0).refresh_node(a):$(b).jstree(!0).refresh())};
ga.fc.delete_node=function(a){a.length&&(ga.fc.url_delete&&0!==ga.fc.url_delete.length?$.ajax({url:ga.fc.url_delete,data:{_window:window.name,_spec:"fc_cache",_delete:a.join(",")},dataType:"json",method:"POST"}).success(function(b){console.log("ajax delete done");b.error&&b.error.length?ga.fc.delete_error_msg(a,b.error):ga.fc.clear("#")}).error(function(a){console.log("ajax error");console.dir(a);ga.fc.ajax_error_msg("ajax delete error: "+a.statusText)}):console.log("ga.fc.delete_node, no url_delete "+
a.join(",")))};ga.fc.delete_node_message=function(a){var b="You are about to permanently remove "+a.length+" file";if(!a.length)return"Can not remove a directory from here";b=1<a.length?b+"s and/or directories":b+" or directory";return b+" and the contents, including subdirectories, of any directory listed below<p>"};
ga.fc.delete_node_message_files=function(a){return a.length?'<div class="table-wrapper"><table><tr><td>'+$.map($.map(a,$.base64.decode),function(a){return a.substr(2)}).join("</td></tr><tr><td>")+"</td></tr></table></div>":""};ga.fc.children=function(a,b){var c,d;b=b||{};if(ga.fc.cache[a])for(c=ga.fc.cache[a].length;c--;)ga.fc.cache[a][c].children&&(d=ga.fc.cache[a][c].id,ga.fc.cache[d]&&(b[d]=!0,b=ga.fc.children(d,b)));return b};ga.fc.cache={};ga.fc.waits={};ga.fc.trees={};
ga.jc=function(a,b){var c,d;ga.jc.cache[a]?b(ga.jc.cache[a]):ga.jc.waits[a]?ga.jc.waits[a].push(b):(ga.jc.waits[a]=[b],$.ajax({url:ga.jc.url,data:{_tree:a,_window:window.name}}).success(function(b){d=ga.jc.waits[a];delete ga.jc.waits[a];b=$.parseJSON(b);ga.jc.cache[a]=b;for(c=d.length;c--;)d[c](b)}).error(function(b){d=ga.jc.waits[a];delete ga.jc.waits[a];console.log("ajax error");console.dir(b);for(c=d.length;c--;)d[c]("**error**");ga.jc.ajax_error_msg("ajax get error: "+b.statusText)}));return!0};
ga.jc.clear_leaf=function(a){var b,c=0,d;for(b in ga.jc.trees)if($(b).length&&(d=$(b).jstree(!0).get_node(a))){c=1;break}c?ga.jc.clear(d.parent):ga.jc.clear("#")};ga.jc.clear=function(a){var b,c=ga.jc.children(a);for(b in c)ga.jc.cache[b]&&delete ga.jc.cache[b];ga.jc.cache[a]&&delete ga.jc.cache[a];for(b in ga.jc.trees)$(b).length&&("#"!==a?$(b).jstree(!0).refresh_node(a):$(b).jstree(!0).refresh())};
ga.jc.refresh=function(a){for(var b in ga.jc.trees)$(b).length&&ga.jc.cache[a]&&("#"!==a?$(b).jstree(!0).refresh_node(a):$(b).jstree(!0).refresh())};
ga.jc.delete_node=function(a){a.length&&(ga.jc.url_delete&&0!==ga.jc.url_delete.length?$.ajax({url:ga.jc.url_delete,data:{_window:window.name,_spec:"fc_cache",_delete:a.join(",")},dataType:"json",method:"POST"}).success(function(b){console.log("ajax delete done");b.error&&b.error.length?ga.jc.delete_error_msg(a,b.error):ga.jc.clear("#")}).error(function(a){console.log("ajax error");console.dir(a);ga.jc.ajax_error_msg("ajax delete error: "+a.statusText)}):console.log("ga.jc.delete_node, no url_delete "+
a.join(",")))};ga.jc.delete_node_message=function(a){var b="You are about to permanently remove "+a.length+" job";1<a.length&&(b+="s");return b};ga.jc.delete_node_message_files=function(a){return a.length?'<div class="table-wrapper"><table><tr><td>'+$.map($.map(a,$.base64.decode),function(a){return a.substr(2)}).join("</td></tr><tr><td>")+"</td></tr></table></div>":""};
ga.jc.children=function(a,b){var c,d;b=b||{};if(ga.jc.cache[a])for(c=ga.jc.cache[a].length;c--;)ga.jc.cache[a][c].children&&(d=ga.jc.cache[a][c].id,ga.jc.cache[d]&&(b[d]=!0,b=ga.jc.children(d,b)));return b};ga.jc.cache={};ga.jc.waits={};ga.jc.trees={};ga.altfile=function(a,b,c){ga.altfile.data[a]=ga.altfile.data[a]||{};ga.altfile.data[a][b]=c};ga.altfile.data={};ga.altfile.bdata={};
ga.altfile.list=function(a){var b;if(ga.altfile.data[a])for(b in ga.altfile.data[a])console.log("module:"+a+" idfile:"+b+" idref:"+ga.altfile.data[a][b]);else console.log("module:"+a+" Empty")};ga.altfile.listall=function(){var a;if(ga.altfile.data)for(a in ga.altfile.data)ga.altfile.list(a);else console.log("ga.altfile:no modules")};ga.altfile.test=function(){ga.altfile("module1","field1","ref1");ga.altfile("module1","field2","ref2");ga.altfile("module2","field3","ref3");ga.altfile.listall()};
ga.altfile.add=function(a){var b,c="",d="#"+a;$(d+" ._hidden_altfiles").remove();$(d+" ._hidden_buttonvals").remove();if(ga.altfile.data[a])for(b in ga.altfile.data[a])c+='<input type="hidden" name="_selaltval_'+b+'" value="'+ga.altfile.data[a][b]+'" class="_hidden_altfiles">';if(ga.altfile.bdata[a])for(b in ga.altfile.bdata[a])c+='<input type="hidden" name="'+b+'" value="'+ga.altfile.bdata[a][b].val+'" class="_hidden_buttonvals">';c.length&&$(d).append(c)};
ga.altfile.button=function(a,b,c,d,e,g){ga.altfile.bdata[a]=ga.altfile.bdata[a]||{};ga.altfile.bdata[a][b]={};ga.altfile.bdata[a][b].val={};ga.altfile.bdata[a][b].text=c;ga.altfile.bdata[a][b].call=d;ga.altfile.bdata[a][b].cb=e;ga.altfile.bdata[a][b].req=g||0};ga.altfile.button.value=function(a,b,c){ga.altfile.bdata[a][b].val=c};
ga.altfile.button.call=function(a,b){var c;ga.altfile.bdata[a][b].call.length?(c=$("#_state").data("_logon"))&&c.length?($("#configbody").load("etc/"+ga.altfile.bdata[a][b].call+".html",function(){ga.altfile.bdata[ga.altfile.bdata[a][b].call]={};ga.altfile.bdata[ga.altfile.bdata[a][b].call].cb=ga.altfile.bdata[a][b].cb;$("#"+ga.altfile.bdata[a][b].call+"text_label").text(ga.altfile.bdata[a][b].text)}),ga.repeats.save(),$(".modalDialog").addClass("modalDialog_on")):messagebox({icon:"warning.png",text:"You must login to browse server information",
buttons:[{id:"ok",label:"OK"}]}):ga.altfile.bdata[a][b].cb("cb");return!1};ga.altfile.button.simplecall=function(a,b){$("#configbody").load("ajax/"+a+"/"+b+".html",function(){});ga.repeats.save();$(".modalDialog").addClass("modalDialog_on");return!1};ga.altfile.button.cb=function(){closeModal()};
ga.altfile.button.lrfile=function(a,b,c){var d=[],e="#"+b,g="#"+c,h="",f="_hidden_lrfile_sels_"+c;$(e+" ."+f).remove();$.each($(a).jstree("get_checked",!0),function(){this.children.length||(h+='<input type="hidden" name="'+c+'_altval[]" value="'+this.id+'" class="'+f+'">',d.push($.base64.decode(this.id).substr(2)))});d.length&&($(g+"_altval").html("<i>Server</i>: "+d),$(g+"_msg").html(""),$(g).val(""),$(e).append(h),ga.value.input[b]&&ga.value.input[b][c]&&ga.value.setInputfromRFile(d,ga.value.input[b][c].mode,
ga.value.input[b][c].ids))};ga.altfile.button.rpath=function(a,b,c){var d=[];b="#"+b;var e="#"+c,g="",h="_hidden_rpath_sels_"+c,f=$(a).jstree(!0);$(b+" ."+h).remove();$.each(f.get_top_checked(!0),function(){f.is_leaf(this)||(g+='<input type="hidden" name="'+c+'[]" value="'+this.id+'" class="'+h+'"><input type="hidden" name="_decodepath_'+c+'" class="'+h+'">',d.push($.base64.decode(this.id).substr(2)))});d.length&&($(e+"_altval").html("<i>Server</i>: "+d),$(e+"_msg").html(""),$(e).val(""),$(b).append(g))};
ga.altfile.button.rfile=function(a,b,c){var d=[],e="#"+b,g="#"+c,h="",f="_hidden_rfile_sels_"+c;$(a).jstree(!0);$(e+" ."+f).remove();$.each($(a).jstree("get_checked",!0),function(){this.children.length||(h+='<input type="hidden" name="'+c+'_altval[]" value="'+this.id+'" class="'+f+'">',d.push($.base64.decode(this.id).substr(2)))});d.length&&($(g+"_altval").html("<i>Server</i>: "+d),$(g+"_msg").html(""),$(g).val(""),$(e).append(h),ga.value.input[b]&&ga.value.input[b][c]&&ga.value.setInputfromRFile(d,
ga.value.input[b][c].mode,ga.value.input[b][c].ids))};ga.altfile.button.job=function(a,b,c){var d="";b="#"+b;var e="#"+c,g="",h="_hidden_job_sels_"+c;$(a).jstree(!0);$(b+" ."+h).remove();$.each($(a).jstree("get_checked",!0),function(){this.children.length||(g+='<input type="hidden" name="'+c+'_altval[]" value="'+this.id+'" class="'+h+'">',d+="<tr><td>"+this.parent+":"+this.text+"</td></tr>")});d.length&&($(e+"_altval").html("<table>"+d+"</table>"),$(e+"_msg").html(""),$(e).val(""),$(b).append(g))};
ga.altfile.button.getnames=function(a,b){var c=[];switch(b){case "rpath":c.push(a+"[]");break;case "rfile":c.push(a+"_altval[]");break;case "lrfile":a=a.replace(/_button$/,"");c.push(a+"_altval[]");break;default:console.warn("ga.altfile.button.getnames( "+a+" , "+b+" )")}return c};
ga.altfile.button.getnamesinput=function(a,b){var c=[];switch(b){case "rpath":c.push(a);break;case "rfile":c.push(a+"_altval");break;case "lrfile":a=a.replace(/_button$/,"");c.push(a+"_altval");break;default:console.warn("ga.altfile.button.getnames( "+a+" , "+b+" )")}return c};
ga.altfile.button.addhtml=function(a,b,c,d){var e="";switch(c){case "rpath":c="_hidden_rpath_sels_"+b;e+='<input type="hidden" name="'+b+'[]" value="'+d[0]+'" class="'+c+'"><input type="hidden" name="_decodepath_'+b+'" class="'+c+'">';break;case "rfile":e+='<input type="hidden" name="'+b+'_altval[]" value="'+d[0]+'" class="'+("_hidden_rfile_sels_"+b)+'">';break;case "lrfile":b=b.replace(/_button$/,"");e+='<input type="hidden" name="'+b+'_altval[]" value="'+d[0]+'" class="'+("_hidden_lrfile_sels_"+
b)+'">';break;default:console.warn("ga.altfile.button.getnames( "+b+" , "+c+" )")}$("#"+a).append(e)};ga.valid={};ga.valid.checkMatch=function(a,b){$(a).val()!=$(b).val()?$(a+"_msg").html(" does not match"):$(a+"_msg").html("")};ga.valid.checkText=function(a){var b=$(a),c=b.val(),d=0,e=b.attr("pattern"),g=new RegExp(e);e?g.test(c)?(d=1,$(a+"_msg").html("")):c.length||b.prop("required")?$(a+"_msg").html(" wrong format"):d=1:!c&&b.prop("required")?$(a+"_msg").html(" missing required field"):d=1;return d};
ga.valid.checkFloat=function(a){var b=$(a),c=b.val(),d=0;c.match(/^-?(([1-9][0-9]*)|(0))?([.][0-9]+)?([eE][-+]?[0-9]+)?$/)?(d=1,c<parseFloat(b.attr("min"))?(b.val(b.attr("min")),$(a+"_msg").html(" value set to minimum allowed")):c>parseFloat(b.attr("max"))?(b.val(b.attr("max")),$(a+"_msg").html(" value set to maximum allowed")):$(a+"_msg").html("")):c.length||b.prop("required")?$(a+"_msg").html(" wrong format"):d=1;return d};
ga.valid.checkInt=function(a){var b=$(a),c=b.val(),d=0;c.match(/^-?((0)|([1-9][0-9]*))$/)?(d=1,c<parseInt(b.attr("min"))?(b.val(b.attr("min")),$(a+"_msg").html(" value set to minimum allowed")):c>parseInt(b.attr("max"))?(b.val(b.attr("max")),$(a+"_msg").html(" value set to maximum allowed")):parseInt(c)!=c?($(a+"_msg").html(" value rounded to nearset integer"),b.val(parseInt(parseFloat(c)+.5))):$(a+"_msg").html("")):c.length||b.prop("required")?$(a+"_msg").html(" wrong format"):d=1;return d};
ga.valid.safeFile=function(a){var b=$(a);b.val().match("^[a-zA-Z0-9]+([a-zA-Z0-9_.-]+|/[a-zA-Z0-9_-])+$")?$(a+"_msg").html(""):(b.val(b.prop("defaultValue")),$(a+"_msg").html("Not an acceptable filename, reset to default"))};ga.valid.checkLrfile=function(a){var b=$(a),c=$(a+"_altval > i");a=$(a+"_msg");var d=0;if(!b||!b.is(":visible"))return 1;b&&b.val()&&b.val().length?d=1:c&&c.html()&&c.html().length&&"Server"===c.html()&&(d=1);d||a.html(" missing required field");return d};
ga.valid.checkRpath=function(a){var b=$(a),c=$(a+"_altval > i");a=$(a+"_msg");var d=0;if(!b||!b.is(":visible"))return 1;c&&c.html()&&c.html().length&&"Server"===c.html()&&(d=1);d||a.html(" missing required field");return d};ga.valid.checkRfile=function(a){var b=$(a),c=$(a+"_altval > i");a=$(a+"_msg");var d=0;if(!b||!b.is(":visible"))return 1;c&&c.html()&&c.html().length&&"Server"===c.html()&&(d=1);d||a.html(" missing required field");return d};
ga.valid.checksubmit=function(a){var b,c=1;if(!ga.altfile.bdata[a]&&!ga.value.types[a])return 1;for(b in ga.altfile.bdata[a])if(ga.altfile.bdata[a][b].req)switch(ga.altfile.bdata[a][b].req){case "lrfile":c=c&&ga.valid.checkLrfile("#"+b);$("#"+b).length&&!ga.valid.checkLrfile("#"+b)&&++ga.fielderrors;break;case "rpath":c=c&&ga.valid.checkRpath("#"+b);$("#"+b).length&&!ga.valid.checkRpath("#"+b)&&++ga.fielderrors;break;case "rfile":c=c&&ga.valid.checkRfile("#"+b);$("#"+b).length&&!ga.valid.checkRfile("#"+
b)&&++ga.fielderrors;break;default:console.log("ga.valid.checksubmit() unsupported required check "+ga.altfile.bdata[a][b].req)}for(b in ga.value.types[a])if(ga.value.types[a][b].req)switch(ga.value.types[a][b].req){case "float":$("#"+b).length&&!ga.valid.checkFloat("#"+b)&&++ga.fielderrors;break;case "integer":$("#"+b).length&&!ga.valid.checkInt("#"+b)&&++ga.fielderrors;break;case "text":$("#"+b).length&&!ga.valid.checkText("#"+b)&&++ga.fielderrors;break;case "file":$("#"+b).length&&!ga.valid.checkLrfile("#"+
b)&&++ga.fielderrors;break;default:console.log("ga.valid.checksubmit() unsupported required check "+ga.value.types[a][b].req)}0<ga.fielderrors&&(c=0);return c};ga.valid.showerrormessage=function(){messagebox({icon:"warning.png",text:""+ga.fielderrors+" fields are missing or not set correctly!",buttons:[{id:"ok",label:"OK"}]});ga.fielderrors=0};ga.valid.clearerrorcounter=function(){ga.fielderrors=0};ga.airavata={};
ga.airavata.select=function(a,b,c,d){var e=ga.airavata.data,g="",h=[],f,n,k;if("__resource__"==a&&!e.defaultresource||"airavata"!=a&&"__resource__"!=a)return"notused";if(!e.resources||!e.resources.length)return messagebox({icon:"warning.png",text:"No resources currently enabled for Airavata submission"}),"abort";if(1==e.resources.length)return Object.keys(e.resources[k])[0];a="__airavataselect__"!=b?b:e.select.length?e.select:"random";switch(a){case "random":return k=Math.floor(e.resources.length*
Math.random()),Object.keys(e.resources[k])[0];case "choose":h.push({id:"submit_module",label:"Submit",data:[c,d,e.resources],cb:function(a){a[0](a[1],Object.keys(a[2][$("#airavata input[name=selectresource]:checked").val()])[0])}});g='<h3>Select a resource compute resource and press submit</h3><form id="airavata"><table>';for(f in e.resources)for(n in e.resources[f])g+='<tr><td><input type="radio" name="selectresource" id="airavata_'+f+'" value="'+f+'"'+(0==f?'checked="checked"':"")+'></td><td class="hoverhighlight" style="text-align:left"><label for="airavata_'+
f+'">'+e.resources[f][n]+"</label></td></tr>";messagebox({icon:"question.png",text:g+"</table>",buttons:h});return"deferred";default:return messagebox({icon:"toast.png",text:"ga.airavata.select, unknown selectoin type '"+a+"'"}),"abort"}};ga.value={};ga.value.settings={};
ga.value.checkFloatIntOK=function(a,b){var c=$(a);if(isNaN(b[0]))return c.val(c.prop("defaultValue")),!1;"float"==c.data("type")?b[0]<parseFloat(c.attr("min"))?(b.splice(0,b.length),b.push(c.attr("min"))):b[0]>parseFloat(c.attr("max"))?(b.splice(0,b.length),b.push(c.attr("max"))):$(a+"_msg").html(""):"integer"==c.data("type")&&(b[0]<parseInt(c.attr("min"))?(b.splice(0,b.length),b.push(c.attr("min"))):b[0]>parseInt(c.attr("max"))?(b.splice(0,b.length),b.push(c.attr("max"))):parseInt(b[0])!=b[0]?(c=
b[0],b.splice(0,b.length),b.push(parseInt(parseFloat(c)+.5))):$(a+"_msg").html(""));return!0};
ga.value.processInputfromFiles=function(a,b,c,d){var e=a.trim().split(/[\r\n]+/g),g=[],h=0;c=ga.repeat.map.convert(c);for(var f=0;f<e.length;f++){var n=e[f].trim().split(/\s+/),h=h+n.length;g.push(h)}var h=[],k=[],q=[],m=[],y=[],r=[],n=[],w=0;switch(b){case "whitespace_formulchcompost":a=[];for(f=0;f<e.length;f++)g=e[f].split("#")[0],g=g.replace(/\s{2,}/g," "),g=g.replace(/\t/g," "),g=g.toString().trim().replace(/(\r\n|\n|\r)/g,""),a.push(g);for(var e=parseInt(a[1]),p,f=0;f<a.length;f++)if(2<f&&f<
3+e)for(p=a[f].trim().split(/\s+/),g=0;g<p.length;g++)k.push(p[g]);else h.push(a[f]);n.push(k);for(f=0;f<c.length;f++)switch($("#"+c[f]).attr("type")){case "text":k=new RegExp($("#"+c[f]).attr("pattern"));if(!k.test(h[f])){messagebox({icon:"warning.png",text:"Wrong format of the input file! Input value on the line #"+w+" is not a valid number. Options are: [Integer | Float point number | Number with exponent]. Check your input file",buttons:[{id:"ok",label:"OK"}]});return}break;case "number":k=[h[f]];
if(ga.value.checkFloatIntOK("#"+c[f],k))h[f]=k[0];else{messagebox({icon:"warning.png",text:"Wrong format of the input file! Input value on the line #"+w+" is not a valid number. Options are: [Integer | Float point number | Number with exponent]. Check your input file",buttons:[{id:"ok",label:"OK"}]});return}break;default:messagebox({icon:"warning.png",text:"Selected input type is currently not supported. Contact the developer",buttons:[{id:"ok",label:"OK"}]});return}break;case "whitespace_formulchrg":case "whitespace_formulchcontrast":a=
[];for(f=0;f<e.length;f++)g=e[f].split("#")[0],g=g.replace(/\s{2,}/g," "),g=g.replace(/\t/g," "),g=g.toString().trim().replace(/(\r\n|\n|\r)/g,""),a.push(g);for(var e=parseInt(a[1]),u=parseInt(a[2+e]),x=parseInt(a[5+e+u]),A=parseInt(a[9+e+u+x]),f=0;f<a.length;f++)if(1<f&&f<2+e)for(p=a[f].trim().split(/\s+/),g=0;g<p.length;g++)k.push(p[g]);else f>2+e&&f<3+e+u?(p=a[f].trim().split(/\s+/),q.push(p[1]),q.push(p[2]),q.push(p[0]),q.push(p[3])):f>5+e+u&&f<6+e+u+x?(p=a[f].trim().split(/\s+/),m.push(p[1]),
m.push(p[2]),m.push(p[0]),m.push(p[3])):f>8+e+u+x&&f<9+e+u+x+A?(p=a[f].trim().split(/\s+/),y.push(p[1]),y.push(p[2]),y.push(p[0]),y.push(p[3])):h.push(a[f]);r.push(k);r.push(q);r.push(m);r.push(y);for(f=g=0;f<c.length;f++)if($("#"+c[f]).length)switch($("#"+c[f]).data("repeater")&&(n.push(r[g]),g++),$("#"+c[f]).attr("type")){case "text":k=new RegExp($("#"+c[f]).attr("pattern"));if(!k.test(h[f])){messagebox({icon:"warning.png",text:"Wrong format of the input file! Input value on the line #"+w+" is not a valid number. Options are: [Integer | Float point number | Number with exponent]. Check your input file",
buttons:[{id:"ok",label:"OK"}]});return}break;case "number":k=[h[f]];if(ga.value.checkFloatIntOK("#"+c[f],k))h[f]=k[0];else{messagebox({icon:"warning.png",text:"Wrong format of the input file! Input value on the line #"+w+" is not a valid number. Options are: [Integer | Float point number | Number with exponent]. Check your input file",buttons:[{id:"ok",label:"OK"}]});return}break;default:messagebox({icon:"warning.png",text:"Selected input type is currently not supported. Contact the developer",buttons:[{id:"ok",
label:"OK"}]});return}else g++;break;case "whitespaceseparated":case "whitespaceseparated_reverselogic":h=a.trim().split(/\s+/);if(h.length==c.length)for(f=0;f<h.length;f++){for(r=0;r<g.length;r++)if(f+1<=g[r]){w=r+1;break}switch($("#"+c[f]).attr("type")){case "checkbox":k=/^(0|1|n|y|true|false|t|f|yes|no)$/;if(!k.test(h[f].toLowerCase())){messagebox({icon:"warning.png",text:"Wrong format of the input file! Checkbox input value on the line #"+w+" is not valid. Options are: [1 | 0 | yes | no | true | false | t | f | T | F | y | n | Y | N ]. Check your input file",
buttons:[{id:"ok",label:"OK"}]});return}break;case "number":k=[h[f]];if(ga.value.checkFloatIntOK("#"+c[f],k))h[f]=k[0];else{messagebox({icon:"warning.png",text:"Wrong format of the input file! Input value on the line #"+w+" is not a valid number. Options are: [Integer | Float point number | Number with exponent]. Check your input file",buttons:[{id:"ok",label:"OK"}]});return}break;case "text":k=new RegExp($("#"+c[f]).attr("pattern"));if(!k.test(h[f])){messagebox({icon:"warning.png",text:"Wrong format of the input file! Input value on the line #"+
w+" is not a valid number. Options are: [Integer | Float point number | Number with exponent]. Check your input file",buttons:[{id:"ok",label:"OK"}]});return}break;default:messagebox({icon:"warning.png",text:"Selected input type is currently not supported. Contact the developer",buttons:[{id:"ok",label:"OK"}]});return}}else{messagebox({icon:"warning.png",text:"Wrong format of the input file! Number of parameters is inconsistent with the model chosen. Check your parameter file",buttons:[{id:"ok",label:"OK"}]});
return}break;default:messagebox({icon:"warning.png",text:"Selected file parsing mode is currently not supported. Contact the developer",buttons:[{id:"ok",label:"OK"}]});return}for(f=w=0;f<h.length;f++){switch($("#"+c[f]).attr("type")){case "checkbox":if(0<=b.indexOf("reverselogic"))switch(h[f].toLowerCase()){case "0":case "false":case "f":case "n":case "no":$("#"+c[f]).prop("checked",!0);break;case "1":case "true":case "t":case "yes":case "y":case "r":$("#"+c[f]).prop("checked",!1);break}else switch(h[f].toLowerCase()){case "0":case "false":case "f":case "n":case "no":$("#"+
c[f]).prop("checked",!1);break;case "1":case "true":case "t":case "yes":case "y":case "r":$("#"+c[f]).prop("checked",!0);break}default:$("#"+c[f]).val(h[f]),$("#"+c[f]).prop("defaultValue",h[f])}if($("#"+c[f]).data("repeater")){ga.repeat.change(d,c[f]);children=ga.repeat.children(d,c[f]);k=$("#"+c[f]).val();m=q=0;for(r=1;r<=k;++r)for(t in m=0,children)if(y=n[w][q],g=c[f]+"-"+t+"-"+(r-1),++m,"whitespace_formulchrg"!=b&&"whitespace_formulchcompost"!=b||1!=m)"whitespace_formulchcompost"==b&&2==m?("r"==
y.toLowerCase()&&$("#"+g).prop("checked",!0),"f"==y.toLowerCase()&&$("#"+g).prop("checked",!1)):"whitespace_formulchcompost"==b&&5==m||$("#"+g).val(y),q++;ga.repeat.change(d,c[f]);w++}}};ga.value.input={};ga.value.setInputForRFile=function(a,b,c,d,e){ga.value.input[a]=ga.value.input[a]||{};ga.value.input[a][c]={};ga.value.input[a][c].id=c;ga.value.input[a][c].tag=b;ga.value.input[a][c].mode=d;ga.value.input[a][c].ids=e};ga.value.types={};
ga.value.registerid=function(a,b,c,d){ga.value.types[a]=ga.value.types[a]||{};ga.value.types[a][b]={};ga.value.types[a][b].id=b;ga.value.types[a][b].label=c;ga.value.types[a][b].req=d||0};ga.value.setInputfromRFile=function(a,b,c,d){var e=c.split(",");a="results/users/"+$("#_state").data("_logon")+"/"+a;$.get(a,function(a){ga.value.processInputfromFiles(a,b,e,d)},"text")};
ga.value.setInputfromFile=function(a,b,c,d){$(a).hide();var e=c.split(",");$(a).change(function(c){c=$(a)[0].files[0];var h=new FileReader;h.onload=function(a){ga.value.processInputfromFiles(a.target.result,b,e,d)};h.readAsText(c)})};
ga.value.setLastValue=function(a,b,c){var d=a+":"+b+":last_value",e=a+":"+b+":default_value",g=$(b);if(!/_output$/.test(a))return!1;if(void 0==$("#global_data").data(d))switch(g.attr("type")){case "checkbox":case "radio":$("#global_data").data(d,g.is(":checked"));$("#global_data").data(e,g.is(":checked"));break;case "div":case "msgs":$("#global_data").data(d,g.html());$("#global_data").data(e,g.html());break;case "plot2d":break;case "filelink":case "filelinkm":$("#global_data").data(d,$(b+"_filelink").html());
break;default:c&&g.val(c),$("#global_data").data(d,g.val()),$("#global_data").data(e,g.val())}else switch(g.attr("type")){case "checkbox":case "radio":g.prop("checked",$("#global_data").data(d));break;case "div":case "msgs":g.html($("#global_data").data(d));break;case "atomicstructure":b=b.replace(/^#/,"");$("#global_data").data(d)?(_jmol_info[b].script=$("#global_data").data(d),g.html(Jmol.getAppletHtml("jmolApplet"+b,_jmol_info[b]))):g.html("");break;case "plot2d":d=gd.data(d);d.data?(ga.value.set.plot2d(b,
d.options),g.plot(d.data,ga.value.get.plot2d.plot_options(b,d.options))):g.plot(d,ga.value.get.plot2d.plot_options(b));break;case "filelink":case "filelinkm":$(b+"_filelink").html($("#global_data").data(d));break;default:g.val($("#global_data").data(d))}};
ga.value.saveLastValue=function(a,b){var c=$(b);switch(c.attr("type")){case "file":break;case "checkbox":case "radio":$("#global_data").data(a+":"+b+":last_value",c.is(":checked"));break;case "div":case "msgs":$("#global_data").data(a+":"+b+":last_value",c.html());break;case "plot2d":break;case "filelink":case "filelinkm":$("#global_data").data(a+":"+b+":last_value",$(b+"_filelink").html());break;case "atomicstructure":c=b.replace(/^#/,"");_jmol_info&&_jmol_info[c]&&_jmol_info[c].length?$("#global_data").data(a+
":"+b+":last_value",_jmol_info[c].script):$("#global_data").data(a+":"+b+":last_value","");break;default:$("#global_data").data(a+":"+b+":last_value",c.val())}};ga.value.saveLastValues=function(a){$("#"+a+" :input").each(function(){ga.value.saveLastValue(a,"#"+$(this).attr("id"))})};
ga.value.resetDefaultValue=function(a,b){var c=$(b);if("SELECT"==c.prop("tagName"))c.val($("#global_data").data(a+":"+b+":default_value"));else switch(c.attr("type")){case "file":return;case "checkbox":$("#global_data").removeData(a+":"+b+":repeat:count");case "radio":c.prop("checked",$("#global_data").data(a+":"+b+":default_value"));break;case "div":case "msgs":c.html($("#global_data").data(a+":"+b+":default_value"));break;case "filelink":case "filelinkm":$(b+"_filelink").html(" ");break;case "plot2d":$("#global_data").data(a+
":"+b+":last_value",[[]]);ga.value.clear.plot2d(b);c.plot([[]],ga.value.get.plot2d.plot_options(b));break;case "image":c.html("");break;case "video":c.html("");break;case "atomicstructure":b.replace(/^#/,"");$("#global_data").data(a+":"+b+":last_value","");$(b).html("");break;default:c.val(c.attr("value"))}ga.value.saveLastValue(a,b);$(b+"_msg").html("")};
ga.value.resetDefaultValues=function(a,b){var c;if(!/_output$/.test(a))return!1;$("#"+a+" :input").each(function(){ga.value.resetDefaultValue(a,"#"+$(this).attr("id"))});ga.sync.reset(a);for(c in ga.value.extra_resets.data)ga.value.resetDefaultValue(a,"#"+c);b&&(ga.value.resetDefaultValue(a,"#"+a+"_msgs"),c="#"+a+"_textarea",ga.value.resetDefaultValue(a,c),$(c).hide(),$(c+"_label").hide())};
ga.value.extra_resets=function(a){ga.value.extra_resets.data=ga.value.extra_resets.data||{};ga.value.extra_resets.data[a]=1};ga.value.extra_resets.clear=function(){ga.value.extra_resets.data={}};
ga.value.setLastValueOutput=function(a){var b="#"+a,c=b+"_textarea",d=$(c);ga.value.setLastValue(a,b+"_msgs");ga.value.setLastValue(a,c);d.val()?(d.show(),$(c+"_label").show(),d.height(parseFloat(d.prop("scrollHeight"))+parseFloat(d.css("borderTopWidth"))+parseFloat(d.css("borderBottomWidth")))):(d.hide(),$(c+"_label").hide())};ga.value.get={};ga.value.set={};ga.value.clear={};
ga.value.set.plot2d=function(a,b){var c=a+"_xlabel",d=a+"_ylabel";$(a+"_title").html(b.title?b.title:"");$(c).html(b.xlabel?b.xlabel:"");$(d).html(b.ylabel?b.ylabel:"")};ga.value.clear.plot2d=function(a){var b=a+"_xlabel",c=a+"_ylabel";tagxy=a+"_xy";$(a+"_title").html("");$(b).html("");$(c).html("");$(tagxy).html("")};ga.value.set.plot2d.pan=function(a,b){ga.value.settings[a]=ga.value.settings[a]||{};ga.value.settings[a].pan=b?!0:!1};
ga.value.set.plot2d.zoom=function(a,b,c){tagxy=a+"_xy";ga.value.settings[a]=ga.value.settings[a]||{};ga.value.settings[a].zoom=b?!0:!1;b&&(ga.value.settings[a].pkg=c,$(a+"_title,"+a+"_xlabel,"+a+"_ylabel,"+a+"_xy").on("click",ga.value.set.plot2d.zoom.click))};ga.value.set.plot2d.pkg=function(a,b){ga.value.settings[b]=ga.value.settings[b]||{};ga.value.settings[b].pkg=a;$(b+"_title,"+b+"_xlabel,"+b+"_ylabel,"+b+"_xy").on("click",ga.value.set.plot2d.reset)};
ga.value.set.plot2d.reset=function(a){var b="#"+a.target.id.replace(/(_title|_xlabel|_ylabel|_xy)$/,"");a.preventDefault();ga.value.setLastValue(ga.value.settings[b].pkg,b)};ga.value.set.plot2d.hover=function(a,b){ga.value.settings[a]=ga.value.settings[a]||{};ga.value.settings[a].hover=b?!0:!1};ga.value.set.plot2d.selzoom=function(a,b){ga.value.settings[a]=ga.value.settings[a]||{};ga.value.settings[a].selzoom=b?!0:!1};
ga.value.set.plot2d.backgroundcolor=function(a,b){ga.value.settings[a]=ga.value.settings[a]||{};ga.value.settings[a].backgroundcolor=b};ga.value.get.plot2d={};
ga.value.get.plot2d.plot_options=function(a,b){var c=ga.plot_options();ga.value.settings[a].backgroundcolor&&(c.grid={backgroundColor:ga.value.settings[a].backgroundcolor});ga.value.settings[a].selzoom&&(c.selection={mode:"xy"});b&&(b.grid&&(c.grid=$.extend({},c.grid,b.grid)),b.selection&&(c.selection=$.extend({},c.selection,b.selection)));c.pan.interactive=ga.value.settings[a].pan?!0:!1;c.zoom.interactive=ga.value.settings[a].zoom?!0:!1;c.grid.hoverable=ga.value.settings[a].hover?!0:!1;if(b){b.legend&&
(c.legend=b.legend,b.legend.container&&(c.legend.container=$(a+"_legend")));b.xmin&&(c.xaxis.min=b.xmin);b.xmax&&(c.xaxis.max=b.xmax);if(b.xscale)switch(b.xscale){case "log":c.xaxis.transform=function(a){return 0<a?Math.log(a):1E-99};c.xaxis.inverseTransform=function(a){return Math.exp(a)};c.xaxis.tickFormatter=ga.value.plot2d.ticformatter;break;default:console.log("ga.value.get.plot2d.plot_options( "+a+" , options ) has unsupported xscale of "+b.xscale)}b.xtics&&(c.xaxis.ticks=b.xtics);b.ymin&&(c.yaxis.min=
b.ymin);b.ymax&&(c.yaxis.max=b.ymax);if(b.yscale)switch(b.yscale){case "log":c.yaxis.transform=function(a){return 0<a?Math.log(a):1E-99};c.yaxis.inverseTransform=function(a){return Math.exp(a)};c.yaxis.tickFormatter=ga.value.plot2d.ticformatter;break;default:console.log("ga.value.get.plot2d.plot_options( "+a+" , options ) has unsupported yscale of "+b.yscale)}b.ytics&&(c.yaxis.ticks=b.ytics)}return c};ga.value.plot2d={};ga.value.plot2d.zstack={};
ga.value.plot2d.zstack.reset=function(a){ga.value.plot2d.stack=ga.value.plot2d.stack||{};ga.value.plot2d.stack[a]=[];ga.value.plot2d.waspush=ga.value.plot2d.waspush||{};ga.value.plot2d.waspush[a]=!1};ga.value.plot2d.zstack.dopop=function(a){ga.value.plot2d.waspush=ga.value.plot2d.waspush||{};return ga.value.plot2d.stack[a]&&ga.value.plot2d.stack[a].length?(ga.value.plot2d.waspush[a]&&ga.value.plot2d.stack[a].pop(),ga.value.plot2d.waspush[a]=!1,ga.value.plot2d.stack[a].pop()):!1};
ga.value.plot2d.zstack.dopush=function(a,b){ga.value.plot2d.stack=ga.value.plot2d.stack||{};ga.value.plot2d.stack[a]=ga.value.plot2d.stack[a]||[];ga.value.plot2d.stack[a].push(b);ga.value.plot2d.waspush=ga.value.plot2d.waspush||{};ga.value.plot2d.waspush[a]=!0};ga.value.plot2d.toFP=function(a,b){return 0<b?a.toFixed(b):6<a.toString().length?a.toExponential(3).replace(/0+e/,"e").replace(/\.e/,"e"):a.toFixed(0)};
ga.value.plot2d.ticformatter=function(a,b){var c;if(!b._ehb||a<=b.min)return b._ehb={},b._ehb.pv=a,b._ehb.min=Math.min(b.min,b.max),b._ehb.max=Math.max(b.min,b.max),b._ehb.tmin=b.options.transform(b._ehb.min),b._ehb.tmax=b.options.transform(b._ehb.max),b._ehb.tmaxr=1/b._ehb.tmax,b._ehb.rnge=b._ehb.max-b._ehb.min,ga.value.plot2d.toFP(a,b.tickDecimals);if(!b._ehb.snd)return b._ehb.snd=!0,b._ehb.sndv=a,b._ehb.ptd=(b.options.transform(a)-b._ehb.tmin)*b._ehb.tmaxr,ga.value.plot2d.toFP(a,b.tickDecimals);
if(!b._ehb.tr)return b._ehb.tr=2*Math.abs(a-b._ehb.sndv)/b._ehb.rnge,b._ehb.ptd=Math.abs(b.options.transform(a)-b._ehb.tmin)*b._ehb.tmaxr,ga.value.plot2d.toFP(a,b.tickDecimals);c=(b.options.transform(a)-b._ehb.tmin)*b._ehb.tmaxr;return Math.min(Math.abs(c-b._ehb.ptd),1-c)>=b._ehb.tr?(b._ehb.ptd=c,ga.value.plot2d.toFP(a,b.tickDecimals)):""};ga.pull={};
ga.pull.clearPull=function(a){a&&"string"==typeof a&&0!=a.length&&"#__fields:repeat__"!=a||(a="");$("#global_data").data("_pull_json"+a,{});$("#global_data").data("_pull_update"+a,{});$("#global_data").data("_pull_type"+a,{})};
ga.pull.toPull=function(a,b,c,d,e){e&&"string"==typeof e&&0!=e.length&&"#__fields:repeat__"!=e||(e="");a=$("#global_data");var g=a.data("_pull_json"+e)||{},h=a.data("_pull_update"+e)||{};g[d]=0;"object"!=typeof h[d]&&(h[d]={});h[d][b]=c;a.data("_pull_json"+e,g);a.data("_pull_update"+e,h)};
ga.pull.doPull=function(a){a&&"string"==typeof a&&0!=a.length&&"#__fields:repeat__"!=a||(a="");var b=$("#global_data"),c=$("#_state").data("_logon");if(c&&c.length){var d=b.data("_pull_json"+a);d._window=window.name;d._logon=c;2<Object.size(d)&&$.getJSON("ajax/sys_config/sys_pull.php",d).done(function(c,d,h){var f=b.data("_pull_update"+a);$.each(c,function(a,b){"object"==typeof f[a]&&$.each(f[a],function(a,c){var d=$(a);switch(c){case "checkbox":d.prop("checked","on"==b);break;case "text":"color"==
d.attr("data-type")&&ga.color.spectrum.val(a,b);case "email":case "text":case "integer":case "float":d.val(b);break;case "listbox":d.empty();$.each(b,function(a,b){d.append($("<option></option>").attr("value",b).text(b))});break;case "label":d.html(b);break;default:console.log("ga.pull.doPull(): not yet")}})})}).fail(function(a,b,c){})}};ga.repeats={};ga.repeats.cache={};ga.repeats.cache._jmol_info={};ga.repeats.cache.specproj=[];
ga.repeats.save=function(){ga.repeats.cache._jmol_info=_jmol_info||{};ga.repeats.cache.specproj=ga.specproj.data||[]};ga.repeats.restore=function(){_jmol_info=ga.repeats.cache._jmol_info;ga.specproj.data=ga.repeats.cache.specproj};ga.repeat={};ga.repeat.data={};ga.repeat.map={};
ga.repeat.repeat=function(a,b,c,d){ga.repeat.data[a]=ga.repeat.data[a]||{};ga.repeat.data[a].repeat=ga.repeat.data[a].repeat||{};ga.repeat.data[a].repeat[b]={};ga.repeat.data[a].repeat[b].html=c;ga.repeat.data[a].repeat[b].eval=d;ga.repeat.map[b]=b;ga.repeat.data[a].repeat[b].htmlr=c.replace(/<\/label>/,"%%label%%</label>").replace(RegExp('id="'+b+'"'),'id="%%id%%"').replace(RegExp('name="'+b),'name="%%id%%').replace(RegExp('for="'+b+'"'),'for="%%id%%"').replace(RegExp('id="'+b+'_msg"'),'id="%%id%%_msg"').replace(RegExp('id="'+
b+'_tr"'),'id="%%id%%_tr"').replace(RegExp('id="'+b+'_button"'),'id="%%id%%_button"').replace(RegExp('="'+b+'_altval"',"g"),'="%%id%%_altval"').replace(RegExp('name="_selaltval_'+b+'"'),'name="_selaltval_%%id%%"').replace(RegExp('id="'+b+'-repeater"'),'id="%%id%%-repeater"');ga.repeat.data[a].repeat[b].htmls=c.replace(/<td><label.*?>(.*?)<\/label>\s*<\/td>/,"%%td%%$1%%etd%%").replace(/(<td[^>]*>).*?<\/td>/g,"$1</td>").replace(/<input[^>]*>/g,"").replace(/<span[^>]*>.*?<\/span>/g,"").replace(/\s*id=".*?"\s*/g,
"").replace("%%td%%","<td>").replace("%%etd%%","</td>").replace("<td></td>","");ga.repeat.data[a].repeat[b].evalr=d.replace(RegExp('"#'+b+'"',"g"),'"#%%id%%"').replace(RegExp('"#'+b+" option","g"),'"#%%id%% option').replace(RegExp(":"+b+":","g"),":%%id%%:").replace(RegExp('"#'+b+'_msg"',"g"),'"#%%id%%_msg"').replace(RegExp('"'+b+'"',"g"),'"%%id%%"').replace(RegExp('"#'+b+'_button"',"g"),'"#%%id%%_button"').replace(RegExp('"'+b+'_altval"',"g"),'"%%id%%_altval"').replace(RegExp('"#'+b+'_altval"',"g"),
'"#%%id%%_altval"');return'<tr><td></td><td><span id="'+b+'-span"></span></td></tr>'};
ga.repeat.repeatOn=function(a,b,c){var d=/^(.*):(.*)$/.exec(c);c=c.replace(":","-");ga.repeat.data[a].repeater=ga.repeat.data[a].repeater||{};ga.repeat.data[a].repeater[c]=ga.repeat.data[a].repeater[c]||{};ga.repeat.data[a].repeater[c].child=ga.repeat.data[a].repeater[c].child||[];ga.repeat.data[a].repeater[c].child.push(b);ga.repeat.data[a].repeat[b].refid=c;d&&(c=d[1],d=d[2],ga.repeat.data[a].repeater[c]=ga.repeat.data[a].repeater[c]||{},ga.repeat.data[a].repeater[c].child=ga.repeat.data[a].repeater[c].child||
[],ga.repeat.data[a].repeater[c].choice=ga.repeat.data[a].repeater[c].choice||[],ga.repeat.data[a].repeater[c].child.push(b),ga.repeat.data[a].repeater[c].choice.push(d))};
ga.repeat.repeater=function(a,b,c,d){ga.repeat.data[a]=ga.repeat.data[a]||{};ga.repeat.data[a].repeater=ga.repeat.data[a].repeater||{};ga.repeat.data[a].repeater[b]=ga.repeat.data[a].repeater[b]||{};ga.repeat.data[a].repeater[b].type=c;d&&"__fields:tableize__"!=d&&!/^(off|false)$/i.test(d)&&(ga.repeat.data[a].repeater[b].tableize=1)};
ga.repeat.children=function(a,b,c){var d;c=c||{};if(!(ga.repeat.data[a]&&ga.repeat.data[a].repeater&&ga.repeat.data[a].repeater[b]&&ga.repeat.data[a].repeater[b].child))return c;for(d=0;d<ga.repeat.data[a].repeater[b].child.length;++d)c[ga.repeat.data[a].repeater[b].child[d]]=!0,ga.repeat.data[a].repeater[d]&&(c=ga.repeat.children(a,d,c));return c};
ga.repeat.change=function(a,b,c){var d,e=[],g="#"+b;d=$(g);var h,f="",n="",k,q,m;if(!(ga.repeat.data[a]&&ga.repeat.data[a].repeater&&ga.repeat.data[a].repeater[b]&&d.length))return!1;switch(ga.repeat.data[a].repeater[b].type){case "checkbox":d=d.prop("checked")?1:0;break;case "integer":case "listbox":d=d.val();break;default:return console.warn("ga.repeat.change( "+a+" , "+b+" ) type "+ga.repeat.data[a].repeater[b].type+" not supported"),!1}if(!c&&ga.repeat.data[a].repeater[b].value===d)return!1;h=
ga.repeat.children(a,b);switch(ga.repeat.data[a].repeater[b].type){case "checkbox":if(d)for(k in h)m=b+"-"+k,ga.repeat.map[k]=m,f+=ga.repeat.data[a].repeat[k].htmlr.replace(/%%id%%/g,m).replace("%%label%%",""),n+=ga.repeat.data[a].repeat[k].evalr.replace(/%%id%%/g,m),ga.repeat.data[a].repeater[k]&&(ga.repeat.data[a].repeater[m]||(ga.repeat.data[a].repeater[m]=jQuery.extend({},ga.repeat.data[a].repeater[k])),e.push(m),ga.repeat.data[a].repeater[m].value&&delete ga.repeat.data[a].repeater[m].value);
break;case "integer":if(ga.repeat.data[a].repeater[b].tableize&&0<d)for(k in h)f+=ga.repeat.data[a].repeat[k].htmls;for(q=1;q<=d;++q)for(k in h)m=b+"-"+k+"-"+(q-1),ga.repeat.map[k]=m,f+=ga.repeat.data[a].repeat[k].htmlr.replace(/%%id%%/g,m).replace("%%label%%","["+q+"]").replace(ga.repeat.data[a].repeater[b].tableize?/<td.*?><label.*?>.*?<\/label><\/td>/:"",""),n+=ga.repeat.data[a].repeat[k].evalr.replace(/%%id%%/g,m),ga.repeat.data[a].repeater[k]&&(ga.repeat.data[a].repeater[m]||(ga.repeat.data[a].repeater[m]=
jQuery.extend({},ga.repeat.data[a].repeater[k])),e.push(m),ga.repeat.data[a].repeater[m].value&&delete ga.repeat.data[a].repeater[m].value);break;case "listbox":h=b.replace(/-[0-9]+$/,"").replace(/^(.*)-([A-ZA-z0-9_]*)$/,"$2")+"-"+d;q=b+"-"+d;h=ga.repeat.children(a,h);for(k in h)m=q+"-"+k,ga.repeat.map[k]=m,f+=ga.repeat.data[a].repeat[k].htmlr.replace(/%%id%%/g,m).replace("%%label%%",""),n+=ga.repeat.data[a].repeat[k].evalr.replace(/%%id%%/g,m),ga.repeat.data[a].repeater[k]&&(ga.repeat.data[a].repeater[m]||
(ga.repeat.data[a].repeater[m]=jQuery.extend({},ga.repeat.data[a].repeater[k])),e.push(m),ga.repeat.data[a].repeater[m].value&&delete ga.repeat.data[a].repeater[m].value);break;default:return console.warn("ga.repeat.change( "+a+" , "+b+" ) type "+ga.repeat.data[a].repeater[b].type+" not supported"),!1}!/^<tr>/.test(f)&&/<\/tr>$/.test(f)&&(f="<tr>"+f);$(g+"-repeater").html(f);eval(n);ga.repeat.data[a].repeater[b].value=d;for(k=0;k<e.length;++k)ga.repeat.change(a,e[k],c);$("#global_data").data("_pull_json#"+
b)&&ga.pull.doPull("#"+b);resetHoverHelp()};ga.repeat.map.convert=function(a){var b,c=[];for(b=0;b<a.length;++b)c[b]=ga.repeat.map[a[b]]||a[b];return c};ga.hide=function(a,b){ga.hide.data=ga.hide.data||{};ga.hide.data[a]=ga.hide.data[a]||{};ga.hide.data[a][b]=ga.hide.data[a][b]||{};ga.hide.data[a][b].active=1};ga.hide.data={};
ga.hide.update=function(a,b){var c;if(ga.hide.data[a]&&ga.hide.data[a][b])if(ga.hide.data[a][b].hides){if($(b).prop("checked"))for(c in ga.hide.data[a][b].hides)$(c+"-itd").html(" "),$(c).hide();else for(c in ga.hide.data[a][b].hides)$(c+"-itd").html(ga.hide.data[a][b].hides[c]),$(c).show();setHoverHelp()}else console.log("ga.hide.update( "+a+" , "+b+" ) error, no hides attached to this hider");else console.log("ga.hide.update( "+a+" , "+b+" ) error, hider has not been defined")};
ga.hide.add=function(a,b,c){ga.hide.data=ga.hide.data||{};ga.hide.data[a]=ga.hide.data[a]||{};ga.hide.data[a][c]=ga.hide.data[a][c]||{};ga.hide.data[a][c].hides=ga.hide.data[a][c].hides||{};ga.hide.data[a][c].hides[b]=$(b+"-itd").html()};ga.directives=function(a,b){ga.directives.data=ga.directives.data||{};ga.directives.data[a]=b};ga.hideifnot=function(a,b){ga.directives.data&&ga.directives.data[b]&&!/^(off|false|0$)/.test(ga.directives.data[b].toLowerCase())||$(a).hide()};ga.data={};
ga.data.nofcrefresh={};
ga.data.update=function(a,b,c,d){var e=0,g=0,h=0,f=0,n=0,k=a+"_output",q="#"+k,m=$(q),y={},r=q+"_msgs",w=$(r),p,u,x,A,v,B,z;c&&($("#"+a+"_progress").html(""),w.text(""));$.each(b,function(b,l){z=m.find("#"+b);if(z.length)switch(e||(w.text(""),e=1),z.attr("type")){case "plot2d":p="#"+b;ga.value.plot2d.zstack.reset(p);l.data?(ga.value.set.plot2d(p,l.options),$.plot(p,l.data,ga.value.get.plot2d.plot_options(p,l.options))):$.plot(p,l,ga.value.get.plot2d.plot_options(p));if(ga.value.settings[p].selzoom||l.options&&
l.options.selection&&l.options.selection.mode&&"xy"==l.options.selection.mode)$(p).on("plotselected",{htag:p,data:l.data?l.data:l,options:l.data?ga.value.get.plot2d.plot_options(p,l.options):ga.value.get.plot2d.plot_options(p)},function(a,b){1E-5>b.xaxis.to-b.xaxis.from&&(b.xaxis.to=b.xaxis.from+1E-5);1E-5>b.yaxis.to-b.yaxis.from&&(b.yaxis.to=b.yaxis.from+1E-5);ga.value.plot2d.zstack.dopush(a.data.htag,b);$.plot(a.data.htag,a.data.data,$.extend(!0,{},a.data.options,{xaxis:{min:b.xaxis.from,max:b.xaxis.to},
yaxis:{min:b.yaxis.from,max:b.yaxis.to}}))}).on("contextmenu",{htag:p,data:l.data?l.data:l,options:l.data?ga.value.get.plot2d.plot_options(p,l.options):ga.value.get.plot2d.plot_options(p)},function(a){a.preventDefault();var b=ga.value.plot2d.zstack.dopop(a.data.htag);b?$.plot(a.data.htag,a.data.data,$.extend(!0,{},a.data.options,{xaxis:{min:b.xaxis.from,max:b.xaxis.to},yaxis:{min:b.yaxis.from,max:b.yaxis.to}})):$.plot(a.data.htag,a.data.data,a.data.options)});x=k+":#"+b+":last_value";$("#global_data").data(x,
l);break;case "atomicstructure":x=k+":#"+b+":last_value";B=l.file?l.file:l;_jmol_info[b].script="set background ["+ga.colors.background+"]; set zoomlarge false;set echo top center;echo loading "+B.split("/").pop()+';refresh;load "'+B+'";';ga.set(a+":jsmoladd")&&(_jmol_info[b].script+=ga.set(a+":jsmoladd"));l.script&&(_jmol_info[b].script+=";"+l.script);$("#global_data").data(x,_jmol_info[b].script);$("#"+b).html(Jmol.getAppletHtml("jmolApplet"+b,_jmol_info[b]));break;case "checkbox":case "radio":z.prop("checked",
!0);break;case "div":z.html(l);break;case "video":u=$("#"+b);v="<video ";u.attr("data-width")&&(v+=' width="'+u.attr("data-width")+'"');u.attr("data-height")&&(v+=' height="'+u.attr("data-height")+'"');v+=" controls>";v+='<source src="'+l+'.mp4" type="video/mp4" /><source src="'+l+'.webm" type="video/webm" />';v+="</video>";u.html(v);break;case "image":u=$("#"+b);v="<img ";u.attr("data-width")&&(v+=' width="'+u.attr("data-width")+'"');u.attr("data-height")&&(v+=' height="'+u.attr("data-height")+'"');
v+=' src="'+l+'">';u.html(v);break;case "filelink":A='<a href="'+l+'" target="_blank">'+l.split("/").pop()+"</a>";x=k+":#"+b+":last_value";$("#global_data").data(x,A);$("#"+b+"_filelink").html(A);break;case "filelinkm":x=k+":#"+b+":last_value";A="";$.each(l,function(a,b){A+='<a href="'+b+'" target="_blank">'+b.split("/").pop()+"</a> "});$("#global_data").data(x,A);$("#"+b+"_filelink").html(A);break;default:$("#global_data").data("_append:"+k+"_"+b)?(z.val(z.val()+"\n"+l),z.height(parseFloat(z.prop("scrollHeight")+
parseFloat(z.css("borderTopWidth"))+parseFloat(z.css("borderBottomWidth"))))):z.val(l)}else c?"_"==b.charAt(0)?/^_fs_/.test(b)&&ga.data.nofcrefresh[a]||("_message"==b&&messagebox(l),/^_getinput/.test(b)&&"_getinput"==b&&ga.valuen.input(a,l),"_textarea"==b&&ga.data.textarea(q,l),"_airavata"==b&&ga.data.airavata(q,l),"_status"==b&&"complete"==l&&c(d,0,0)):(g||(w.append("<p>Unexpected results:</p>"),g=1),w.append("<p>"+b+" => "+l+"</p>")):"_"==b.charAt(0)?/^_fs_/.test(b)&&ga.data.nofcrefresh[a]||($("#_state").data(b,
l),h=1,"_status"==b&&(y.job_status=l),/^_getinput/.test(b)&&"_getinput"==b&&ga.valuen.input(a,l),"_textarea"==b&&ga.data.textarea(q,l),"_airavata"==b&&ga.data.airavata(q,l),"_loginverify"==b&&ga.login.verify(l),"_loginapprove"==b&&ga.login.approve(l)):"-close"==b?f=1:"-close2"==b?n=1:(g||(w.text(""),w.append("<p>Unexpected results:</p>"),e=g=1),w.append("<p>"+b+" => "+l+"</p>"))});ga.value.saveLastValues(k);ga.value.saveLastValue(k,r);$(q+"_progress").html("");h&&syncState();f&&closeModal();n&&closeModal2();
return y};
ga.data.textarea=function(a,b){var c=a+"_textarea",d=$(c);isatend=d[0].scrollHeight-d[0].scrollTop===d[0].clientHeight;d.is(":hidden")&&(d.show(),$(c+"_label").show());"__reset__\n"==b.substr(0,10)?d.val(b.substr(10)):d.val(d.val()+b);ga.set("textarea:rows")?ga.data.textarea.h[a]?d.height(ga.data.textarea.h[a]):ga.data.textarea.h[a]=parseFloat(d.prop("clientHeight"))+parseFloat(d.css("borderTopWidth"))+parseFloat(d.css("borderBottomWidth")):d.height(parseFloat(d.prop("scrollHeight"))+parseFloat(d.css("borderTopWidth"))+parseFloat(d.css("borderBottomWidth")));
isatend&&d.scrollTop(d[0].scrollHeight)};ga.data.textarea.h={};ga.data.airavata=function(a,b){var c=$(a+"_airavata");c.is(":hidden")&&c.show();c.html(b)};
ga.sync=function(a,b,c){var d,e=$("#"+b),g;if(e&&ga.sync.data&&ga.sync.data[a]&&ga.sync.data[a][c]){ga.sync.data[a][c][b]=!0;for(d in ga.sync.data[a][c])if(d!=b&&(g=$("#"+d))&&$.isNumeric(g.val())){e.val(g.val());e.change();return}ga.sync.data[a][c]._lastval&&$.isNumeric(ga.sync.data[a][c]._lastval)&&(e.val(ga.sync.data[a][c]._lastval),e.change())}else ga.sync.data=ga.sync.data||{},ga.sync.data[a]=ga.sync.data[a]||{},ga.sync.data[a][c]=ga.sync.data[a][c]||{},ga.sync.data[a][c][b]=!0};
ga.sync.change=function(a,b,c){var d,e=$("#"+b);if(e&&$.isNumeric(e.val())&&ga.sync.data&&ga.sync.data[a]&&ga.sync.data[a][c])for(d in ga.sync.data[a][c]._lastval=e.val(),ga.sync.data[a][c])d!=b&&(a=$("#"+d))&&a.val()!=e.val()&&(a.val(e.val()),a.change())};ga.sync.reset=function(a){var b;if(ga.sync.data&&ga.sync.data[a])for(b in ga.sync.data[a])ga.sync.data[a][b]._lastval&&delete ga.sync.data[a][b]._lastval};ga.valuen={};ga.valuen.data={};ga.valuen.html={};ga.valuen.dflt={};ga.valuen.dflt.data={};
ga.valuen.dflt.html={};ga.valuen.lastload="";
ga.valuen.restore=function(a,b,c){var d="#"+a,e=$(d),g=e.find(":input").get(),h={},f,n;b=b||ga.valuen.data[a];c=c||ga.valuen.html[a];if(b){$(d+" .field_msg").html("");do f=!1,$.each(g,function(){var c,d,m=$(this),n,r;if(m.attr("data-repeater")&&!h[this.name]){h[this.name]=!0;if(this.name&&(b[this.name]||/checkbox|radio/i.test(this.type))){d=b[this.name];if(/checkbox|radio/i.test(this.type)){n=m.val();r=!1;if(d)for(c=0;c<d.length;c++)if(d[c]==n){r=!0;break}m.prop("checked",r)}else m.val(d[0]);f=!0;
ga.repeat.change(a,this.name,!0);g=e.find(":input").get();return!1}b[this.name]||/checkbox|radio/i.test(this.type)||console.warn("ga.valuen.restore() no data found for repeater setting value on "+this.name+" type "+this.type+" to "+d[0])}});while(f);$.each(g,function(){var c,d,e,f,g;if(this.name&&!h[this.name])if(e=$(this),(b[this.name]||/checkbox|radio/i.test(this.type))&&!/button/i.test(this.nodeName))if(d=b[this.name],/checkbox|radio/i.test(this.type)){f=e.val();g=!1;if(d)for(c=0;c<d.length;c++)if(d[c]==
f){g=!0;break}e.prop("checked",g)}else"file"===this.type?d[0]?$("#"+this.id+"_msg").html(" "+d[0]+" please reload manually (programmatic setting of local files disallowed by browser security)"):e.val(""):e.val(d[0]);else if(/button/i.test(this.nodeName)&&(d=e.attr("data-type"))&&(e=ga.altfile.button.getnames(this.id,d)))for(c=0;c<e.length;++c)b[e[c]]&&ga.altfile.button.addhtml(a,this.id,d,b[e[c]])});for(n in c)$("#"+n).html(c[n])}};
ga.valuen.restore.dflt=function(a){return ga.valuen.restore(a,ga.valuen.dflt.data[a],ga.valuen.dflt.html[a])};
ga.valuen.save=function(a,b){var c=$("#"+a).find(":input").get();data={};html={};$.each(c,function(){var a=$(this),b=this.name&&!this.disabled,c=a.attr("data-add");if(b){if(this.checked||/select|textarea/i.test(this.nodeName)||/file|email|number|text|hidden|password/i.test(this.type))void 0==data[this.name]&&(data[this.name]=[]),data[this.name].push(a.val());c&&(void 0==html[c]&&(html[c]=[]),html[c].push($("#"+c).html()))}});b?(ga.valuen.dflt.data[a]=data,ga.valuen.dflt.html[a]=html):(ga.valuen.data[a]=
data,ga.valuen.html[a]=html)};
ga.valuen.input=function(a,b){var c=$("#"+a),d=c.find(":input").get(),e={},g;if(b){do g=!1,$.each(d,function(){var h,f,n=$(this),k,q;if(n.attr("data-repeater")&&!e[this.name]){e[this.name]=!0;if(this.name&&(b[this.name]||/checkbox|radio/i.test(this.type))){f=b[this.name];"[object Array]"!==Object.prototype.toString.call(f)&&(f=[f]);if(/checkbox|radio/i.test(this.type)){k=n.val();q=!1;if(f)for(h=0;h<f.length;h++)if(f[h]==k){q=!0;break}n.prop("checked",q)}else n.val(f[0]);g=!0;ga.repeat.change(a,this.name,
!0);d=c.find(":input").get();return!1}b[this.name]||/checkbox|radio/i.test(this.type)||console.warn("ga.valuen.input() no data found for repeater setting value on "+this.name+" type "+this.type+" to "+f[0])}});while(g);$.each(d,function(){var c,d,g,k,q;if(this.name&&!e[this.name])if(g=$(this),(b[this.name]||/checkbox|radio/i.test(this.type))&&!/button/i.test(this.nodeName))if(d=b[this.name],"[object Array]"!==Object.prototype.toString.call(d)&&(d=[d]),/checkbox|radio/i.test(this.type)){k=g.val();
q=!1;if(d)for(c=0;c<d.length;c++)if(d[c]==k){q=!0;break}g.prop("checked",q)}else"file"===this.type?d[0]&&$("#"+this.id+"_msg").html(" "+d[0]+" please reload manually (programmatic setting of local files disallowed by browser security)"):g.val(d[0]);else if(/button/i.test(this.nodeName)&&(d=g.attr("data-type"))&&(g=ga.altfile.button.getnames(this.id,d),typenamesinput=ga.altfile.button.getnamesinput(this.id,d),g))for(c=0;c<g.length;++c)b[typenamesinput[c]]&&ga.altfile.button.addhtml(a,this.id,d,b[typenamesinput[c]])});
$.each(b,function(a,b){var c;/^_html_/.test(a)&&(a=a.replace(/^_html_/,""),(c=$("#"+a))&&c.html(b))})}else console.warn("ga.valuen.input( "+a+" ) no data")};ga.valuen.addhtml=function(a){a=$("#"+a);var b=a.find(":input").get(),c="";$.each(b,function(){var a=$(this),b=this.name&&!this.disabled,a=a.attr("data-add");b&&a&&(c+='<input type="hidden" name="_html_'+a+'" value="'+$("#"+a).html()+'">')});a.append(c)};
ga.valuen.reset=function(){ga.valuen.data={};ga.valuen.html={};ga.valuen.dflt={};ga.valuen.dflt.data={};ga.valuen.dflt.html={};ga.valuen.lastload=""};
ga.license=function(a){a=a.split(",");var b=[],c,d=[],e;a.length&&(c="<p>Submitting to this module requires "+(1<a.length?"approved licenses":"an approved license")+" for <em>"+a.join("</em> and <em>")+"</em></p>");for(e in a)if(d.push({id:a[e],label:a[e]+" Management",data:a[e],cb:function(a){return ga.altfile.button.simplecall("license",a)}}),ga.license.data[a[e]]&&ga.license.data[a[e]].status)switch(ga.license.data[a[e]].status){case "approved":break;case "denied":c+="<p>Your license request for <em>"+
a[e]+"</em> has been <strong>denied</strong>.</p>";b.push(a[e]);break;case "pending":c+="<p>Your license request for <em>"+a[e]+"</em> is pending approval.</p>";b.push(a[e]);break;default:console.warn("ga.license() "+a[e]+" unknown status "+ga.license.data[a[e]].status),b.push(a[e])}else b.push(a[e]);return b.length?(messagebox({icon:"warning.png",text:c,buttons:d}),!1):!0};ga.license.data={};
ga.license.get=function(){ga.license.data={};ga.license.url&&$.getJSON(ga.license.url,{tagmode:"any",format:"json",_window:window.name,_logon:$("#_state").data("_logon")}).done(function(a,b,c){a.license&&(ga.license.data=a.license);a.restricted?ga.restricted.show(a.restricted):ga.restricted.hideall()}).fail(function(a,b,c){console.warn("could not get license data")})};
ga.captcha=function(a,b){var c="";$.ajax({url:ga.captcha.url,data:{_window:window.name}}).success(function(d){d=$.parseJSON(d);d.error?messagebox({icon:"toast.png",text:d.error}):(c='<img src="data:image/png;base64,'+d.captcha+'"><form id="sys_captcha"><label for="sys_captcha_text">Verify </label><input id="sys_captcha_text" class="help_link" type="text" maxlength="6" size="6" required><span class="help">Enter the 6 character alphanumeric code shown in the image and then press submit</span><input id="sys_captcha_id" type="hidden" value="'+
d.id+'"></form>',messagebox({text:c,eval:"resetHoverHelp();$('#sys_captcha').on('keyup keypress', function(e) { var code = e.keyCode || e.which;  if (code  == 13) { e.preventDefault(); return false; }});",buttons:[{id:"submit",label:"Submit",cb:ga.captcha.verify,data:{cb:a,data:b}}]}))}).error(function(a){messagebox({icon:"toast.png",text:"Error contacting server"})})};
ga.captcha.verify=function(a){$.ajax({url:ga.captcha.url_verify,data:{_window:window.name,captcha:$("#sys_captcha_text").val(),id:$("#sys_captcha_id").val()}}).success(function(b){b=$.parseJSON(b);if(b.error)messagebox({icon:"toast.png",text:b.error});else if(b.success)a.cb(a.data);else return ga.captcha(a.cb,a.data)}).error(function(a){messagebox({icon:"toast.png",text:"Error contacting server"})})};
ga.register=function(a){a=a.split(",");var b=[],c,d=[],e;a.length&&(c="<p>Submitting to this module requires "+(1<a.length?"approved registers":"an approved register")+" for <em>"+a.join("</em> and <em>")+"</em></p>");for(e in a)if(d.push({id:a[e],label:a[e]+" Management",data:a[e],cb:function(a){return ga.altfile.button.simplecall("register",a)}}),ga.register.data[a[e]]&&ga.register.data[a[e]].status)switch(ga.register.data[a[e]].status){case "approved":break;case "denied":c+="<p>Your register request for <em>"+
a[e]+"</em> has been <strong>denied</strong>.</p>";b.push(a[e]);break;case "pending":c+="<p>Your register request for <em>"+a[e]+"</em> is pending approval.</p>";b.push(a[e]);break;default:console.warn("ga.register() "+a[e]+" unknown status "+ga.register.data[a[e]].status),b.push(a[e])}else b.push(a[e]);return b.length?(messagebox({icon:"warning.png",text:c,buttons:d}),!1):!0};ga.register.data={};
ga.register.get=function(){ga.register.data={};ga.register.url&&$.getJSON(ga.register.url,{tagmode:"any",format:"json",_window:window.name,_logon:$("#_state").data("_logon")}).done(function(a,b,c){a.register&&(ga.register.data=a.register);a.restricted?ga.restricted.show(a.restricted):ga.restricted.hideall()}).fail(function(a,b,c){console.warn("could not get register data")})};ga.calc={};ga.calc.data={};ga.calc.str_atom_numeric="(?:(?:-?[1-9][0-9]*)|(?:-?0))?(?:[.][0-9]+)?(?:[eE][-+]?[0-9]+)?";
ga.calc.str_atom_id="[A-Za-z][A-Za-z0-9_]*";ga.calc.str_function="(?:abs\\(|acos\\(|asin\\(|atan\\(|atan2\\(|ceil\\(|cos\\(|exp\\(|floor\\(|log\\(|max\\(|min\\(|pow\\(|random\\(|round\\(|sin\\(|sqrt\\(|tan\\(|-)";ga.calc.str_function_paren="(?:abs\\(|acos\\(|asin\\(|atan\\(|atan2\\(|ceil\\(|cos\\(|exp\\(|floor\\(|log\\(|max\\(|min\\(|pow\\(|random\\(|round\\(|sin\\(|sqrt\\(|tan\\()";ga.calc.str_function_no_paren="-";ga.calc.str_binary="[-,+*/^]";ga.calc.str_open_paren="\\(";
ga.calc.str_close_paren="\\)";ga.calc.str_paren="[()]";ga.calc.is_atom_numeric=RegExp("^"+ga.calc.str_atom_numeric+"$");ga.calc.is_atom_id=RegExp("^"+ga.calc.str_atom_id+"$");ga.calc.is_function=RegExp("^"+ga.calc.str_function+"$");ga.calc.is_function_paren=RegExp("^"+ga.calc.str_function_paren+"$");ga.calc.is_function_no_paren=RegExp("^"+ga.calc.str_function_no_paren+"$");ga.calc.is_binary=RegExp("^"+ga.calc.str_binary+"$");ga.calc.is_open_paren=RegExp("^"+ga.calc.str_open_paren+"$");
ga.calc.is_close_paren=RegExp("^"+ga.calc.str_close_paren+"$");ga.calc.is_paren=RegExp("^"+ga.calc.str_paren+"$");ga.calc.is_atom=RegExp("^("+ga.calc.str_atom_id+"|"+ga.calc.str_atom_numeric+")$");ga.calc.inc_paren=RegExp("^("+ga.calc.str_paren+"|"+ga.calc.str_function_paren+")$");ga.calc.precedence={"^":4,"*":5,"/":5,"+":6,"-":6,",":8};
ga.calc.register=function(a,b,c){ga.calc.data[a]=ga.calc.data[a]||{};ga.calc.data[a].calc=ga.calc.data[a].calc||{};ga.calc.data[a].calc[b]={};ga.calc.data[a].calc[b].calc=c;ga.calc.data[a].calc[b].tokens=ga.calc.tokens(c);ga.calc.data[a].calc[b].tokens._error?messagebox({icon:"toast.png",text:"Module field calc internal error: "+ga.calc.data[a].calc[b].tokens._error+" in calc field id "+b}):(ga.calc.data[a].calc[b].dependents=ga.calc.dependents(a,b),99<ga.calc.depthofdeps(a,b)?messagebox({icon:"toast.png",
text:"Module field calc internal error: maximum recursion depth found in calc field id "+b}):(ga.calc.data[a].calc[b].tree=ga.calc.mktree(ga.calc.data[a].calc[b].tokens),ga.calc.data[a].calc[b].tree._error?messagebox({icon:"toast.png",text:"Module field calc internal error: "+ga.calc.data[a].calc[b].tree._error+" in calc field id "+b}):ga.calc.install(a,b)))};
ga.calc.depthofdeps=function(a,b,c){var d,e,g=0;c=c||0;ga.calc.data[a].calc[b].dependents&&c++;if(99<c)return c;for(d=0;d<ga.calc.data[a].calc[b].dependents.length;++d)ga.calc.data[a].calc[ga.calc.data[a].calc[b].dependents[d]]&&(e=ga.calc.depthofdeps(a,ga.calc.data[a].calc[b].dependents[d],c),g<e&&(g=e));return c+g};
ga.calc.dependents=function(a,b){var c,d=[];for(c in ga.calc.data[a].calc[b].tokens)ga.calc.is_atom_id.test(ga.calc.data[a].calc[b].tokens[c])&&d.push(ga.calc.data[a].calc[b].tokens[c]);return d};ga.calc.install=function(a,b){for(var c in ga.calc.data[a].calc[b].dependents)$("#"+ga.calc.data[a].calc[b].dependents[c]).on("change",function(){ga.calc.process(a,b)})};
ga.calc.process=function(a,b){var c=ga.calc.evaltree(jQuery.extend(!0,{},ga.calc.data[a].calc[b].tree));c._error?messagebox({icon:"toast.png",text:"Module field calc internal error: "+ga.calc.data[a].calc[b].tokens._error+" in calc field id "+b}):$("#"+b).val(c).trigger("change")};
ga.calc.tokens=function(a){var b=[],c,d=[],e=RegExp("^("+ga.calc.str_function_paren+"|"+ga.calc.str_atom_id+"|"+ga.calc.str_paren+"|"+ga.calc.str_atom_numeric+"|"+ga.calc.str_function_no_paren+")"),g=RegExp("^("+ga.calc.str_binary+"|"+ga.calc.str_close_paren+")"),h=500;a=a.replace(/\s+/g,"");d.push(0);do{if(0<d.length&&d[d.length-1]){c=g.exec(a);if(!c)return{_error:"Invalid token found "+a};if(ga.calc.is_close_paren.test(c[0])){if(!d.length)return{_error:"Invalid closing parenthesis "+a};d.pop()}else d[d.length-
1]=0}else{c=e.exec(a);if(!c)return{_error:"Invalid token found "+a};if(ga.calc.is_atom.test(c[0]))d[d.length-1]=1;else if(ga.calc.is_open_paren.test(c[0]))d.push(0);else if(ga.calc.is_close_paren.test(c[0])){if(!d.length)return{_error:"Invalid closing parenthesis "+a};d.pop()}else ga.calc.is_function_paren.test(c[0])&&d.push(0)}a=a.substring(c[0].length);b.push(c[0])}while(c&&c.length&&a.length&&0<--h);return 0>=h?{_error:"maximum token limit of 500 reached"}:b};
ga.calc.parensub=function(a){for(var b=1,c={a:[]},d=1;d<a.length;++d){if(")"==a[d]&&(b--,0==b))return c.newofs=d,c;c.a.push(a[d]);/\($/.test(a[d])&&b++}return{_error:"Closing parenthesis error"}};
ga.calc.mktree=function(a,b){for(var c=[],d=null,e,g,h=0;h<a.length;++h){token=a[h];if(ga.calc.is_function_paren.test(token)){e=ga.calc.parensub(a.slice(h));if(e._error)return e;h+=e.newofs;token={op:token,args:[e=ga.calc.mktree(e.a)]};g=1;if(e._error)return e}else if(ga.calc.is_open_paren.test(token)){e=ga.calc.parensub(a.slice(h));if(e._error)return e;h+=e.newofs;token=ga.calc.mktree(e.a);if(token._error)return token;g=1}else g=0;g||ga.calc.is_atom.test(token)?(c.push(token),d&&(b?ga.calc.precedence[d]<
ga.calc.precedence[b.op]?(console.log("replace 2nd arg"),b.args[1]={op:d,args:[b.args[1],token]}):(console.log("replace parent object"),b={op:d,args:[b,token]}):(b={op:d,args:c},d=null,c=[]))):ga.calc.is_binary.test(token)&&(d=token)}!b&&c.length&&(b={op:"()",args:c});return b};ga.calc.arraytovals=function(a){var b;if(a.constructor===Array)for(b=0;b<a.length;++b)a[b]=Number(ga.calc.is_atom_id.test(a[b])?$("#"+a[b]).val():a[b]);else a=Number(ga.calc.is_atom_id.test(a)?$("#"+a).val():a);return a};
ga.calc.evaltree=function(a){var b,c,d,e,g,h,f,n,k;d=1;if(!a)return{_error:"no object in ga.calc.evaltree"};if(a._error)return a;if(!a.op)return{_error:"no op in object in ga.calc.evaltree"};if(!a.args)return{_error:"no args in object in ga.calc.evaltree"};if(1>a.args.length||2<a.args.length)return{_error:"args incorrect length in object in ga.calc.evaltree"};(c=2==a.args.length)&&"undefined"==typeof a.args[1]&&(c=0);"undefined"==typeof a.args[0]&&(d=0);d&&a.args[0].op&&(a.args[0]=ga.calc.evaltree(a.args[0]));
c&&a.args[1].op&&(a.args[1]=ga.calc.evaltree(a.args[1]));d&&(a.args[0]=ga.calc.arraytovals(a.args[0]),c&&(a.args[1]=ga.calc.arraytovals(a.args[1])));d=d&&a.args[0].constructor===Array;c&&(e=a.args[1].constructor===Array,b=d||e,(g=d&&e)?a.args[0].length<a.args[1].length?(h=a.args[0],f=a.args[1],n=1):(h=a.args[1],f=a.args[0],n=0):b&&(f=a.args[d?0:1],k=a.args[d?1:0]));switch(a.op){case ",":b=d?a.args[0]:[a.args[0]];c&&"undefined"!=typeof a.args[1]&&(b=b.concat(e?a.args[1]:[a.args[1]]));break;case "()":c?
(b=d?a.args[0]:[a.args[0]],c&&a.args[1]&&(b=b.concat(e?a.args[1]:[a.args[1]]))):b=a.args[0];break;case "+":if(!c)return{_error:"operator : "+a.op+" is binary and only has one argument"};if(b)if(b=f,g)for(c=0;c<h.length;++c)b[c]+=h[c];else for(c=0;c<f.length;++c)b[c]+=k;else b=a.args[0]+a.args[1];break;case "*":if(!c)return{_error:"operator : "+a.op+" is binary and only has one argument"};if(b)if(b=f,g)for(c=0;c<h.length;++c)b[c]*=h[c];else for(c=0;c<f.length;++c)b[c]*=k;else b=a.args[0]*a.args[1];
break;case "-":if(!c)return{_error:"operator : "+a.op+" is binary and only has one argument"};if(b)if(g){b=a.args[0];for(c=0;c<h.length;++c)b[c]-=a.args[1][c];if(n)for(c=a.args[0].length;c<a.args[1].length;++c)b.push(-a.args[1][c]);else for(c=a.args[1].length;c<a.args[0].length;++c)b.push(a.args[0][c])}else if(d)for(b=a.args[0],c=0;c<a.args[0].length;++c)b[c]-=a.args[1];else for(b=[],c=0;c<a.args[1].length;++c)b.push(a.args[0]-a.args[1][c]);else b=a.args[0]-a.args[1];break;case "/":if(!c)return{_error:"operator : "+
a.op+" is binary and only has one argument"};if(b)if(g){b=a.args[0];for(c=0;c<h.length;++c)b[c]/=a.args[1][c];if(n)for(c=a.args[0].length;c<a.args[1].length;++c)b.push(0);else for(c=a.args[1].length;c<a.args[0].length;++c)b.push(a.args[0][c]/0)}else if(d)for(b=a.args[0],c=0;c<a.args[0].length;++c)b[c]/=a.args[1];else for(b=[],c=0;c<a.args[1].length;++c)b.push(a.args[0]/a.args[1][c]);else b=a.args[0]/a.args[1];break;case "^":if(!c)return{_error:"operator : "+a.op+" is binary and only has one argument"};
if(b)if(g){b=a.args[0];for(c=0;c<h.length;++c)b[c]=Math.pow(b[c],a.args[1][c]);if(n)for(c=a.args[0].length;c<a.args[1].length;++c)b.push(0);else for(c=a.args[1].length;c<a.args[0].length;++c)b.push(1)}else if(d)for(b=a.args[0],c=0;c<a.args[0].length;++c)b[c]=pow(b[c],a.args[1]);else for(b=[],c=0;c<a.args[1].length;++c)b.push(pow(a.args[0],a.args[1][c]));else b=Math.pow(a.args[0],a.args[1]);break;case "abs(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];
if(d)for(c=0;c<b.length;++c)b[c]=Math.abs(b[c]);else b=Math.abs(a.args[0]);break;case "acos(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.acos(b[c]);else b=Math.acos(a.args[0]);break;case "asin(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.asin(b[c]);else b=Math.asin(a.args[0]);break;case "atan(":if(c)return{_error:"operator : "+
a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.atan(b[c]);else b=Math.atan(a.args[0]);break;case "ceil(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.ceil(b[c]);else b=Math.ceil(a.args[0]);break;case "cos(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.cos(b[c]);else b=Math.cos(a.args[0]);
break;case "exp(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.exp(b[c]);else b=Math.exp(a.args[0]);break;case "floor(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.floor(b[c]);else b=Math.floor(a.args[0]);break;case "log(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=
Math.log(b[c]);else b=Math.log(a.args[0]);break;case "random(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.random();else b=Math.random();break;case "round(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.round(b[c]);else b=Math.round(a.args[0]);break;case "sin(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};
b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.sin(b[c]);else b=Math.sin(a.args[0]);break;case "sqrt(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.sqrt(b[c]);else b=Math.sqrt(a.args[0]);break;case "tan(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=a.args[0];if(d)for(c=0;c<b.length;++c)b[c]=Math.tan(b[c]);else b=Math.tan(a.args[0]);break;case "max(":if(c)return{_error:"operator : "+
a.op+" has 2 arguments but only accepts one"};b=d?Math.max.apply(null,a.args[0]):a.args[0];break;case "min(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};b=d?Math.min.apply(null,a.args[0]):a.args[0];break;case "atan2(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};if(!d)return{_error:"operator : "+a.op+"  needs the first argument to be an even sized array"};b=[];for(c=0;c<a.args[0].length;c+=2)b.push(Math.atan2(a.args[0][c],a.args[0][c+
1]));break;case "pow(":if(c)return{_error:"operator : "+a.op+" has 2 arguments but only accepts one"};if(!d)return{_error:"operator : "+a.op+"  needs the first argument to be an even sized array"};b=[];for(c=0;c<a.args[0].length;c+=2)b.push(Math.pow(a.args[0][c],a.args[0][c+1]));1==b.length&&(b=b[0]);break;default:return{_error:"operator : "+a.op+" unknown or unsupported"}}return b};
